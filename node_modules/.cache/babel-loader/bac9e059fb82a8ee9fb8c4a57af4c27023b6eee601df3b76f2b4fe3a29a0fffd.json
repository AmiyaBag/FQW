{"ast":null,"code":"var _jsxFileName = \"D:\\\\Amina\\\\VScode\\\\FQW_new\\\\src\\\\components\\\\Documents.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useMemo, useCallback } from 'react';\nimport axios from 'axios';\nimport { useNavigate } from 'react-router-dom';\nimport Modal from 'react-modal';\nimport './Documents.css';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst apiUrl = process.env.REACT_APP_API_URL;\n\n// Set the app element for react-modal accessibility\nModal.setAppElement('#root'); // Adjust '#root' if your app's root element has a different ID\n\n// Вспомогательная функция для форматирования даты\nconst formatDate = dateStr => {\n  if (!dateStr) return 'N/A';\n  try {\n    const date = new Date(dateStr);\n    return isNaN(date.getTime()) ? 'Неверная дата' : date.toLocaleDateString('ru-RU');\n  } catch (e) {\n    console.error(\"Error formatting date:\", dateStr, e);\n    return 'Ошибка даты';\n  }\n};\nfunction Documents() {\n  _s();\n  const [documents, setDocuments] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState('');\n  const [user, setUser] = useState(null);\n  const [workers, setWorkers] = useState([]);\n  const [selectedWorker, setSelectedWorker] = useState(null);\n  const [isModalOpen, setIsModalOpen] = useState(false);\n  const [selectedDocumentForModal, setSelectedDocumentForModal] = useState(null);\n  const [sortConfig, setSortConfig] = useState({\n    key: 'DateIssue',\n    direction: 'descending'\n  });\n  const navigate = useNavigate();\n  // --- Modal Handlers ---\n  const openModal = doc => {\n    console.log(\"Opening modal for doc:\", doc);\n    setSelectedDocumentForModal(doc);\n    setIsModalOpen(true);\n  };\n  const closeModal = () => {\n    setIsModalOpen(false);\n    setSelectedDocumentForModal(null); // Clear selected doc when closing\n  };\n  // Helper function to sort documents\n  const sortDocuments = (docs, config) => {\n    if (!config.key) return docs;\n    return [...docs].sort((a, b) => {\n      // Handle date fields specially\n      if (['DateIssue', 'DataStart', 'DataEnd'].includes(config.key)) {\n        const dateA = a[config.key] ? new Date(a[config.key]).getTime() : 0;\n        const dateB = b[config.key] ? new Date(b[config.key]).getTime() : 0;\n        if (dateA < dateB) {\n          return config.direction === 'ascending' ? -1 : 1;\n        }\n        if (dateA > dateB) {\n          return config.direction === 'ascending' ? 1 : -1;\n        }\n        return 0;\n      }\n      // Handle numeric fields\n      if (['ID_Document', 'ID_Worker', 'ID_ProgDPO'].includes(config.key)) {\n        const valA = a[config.key] || 0;\n        const valB = b[config.key] || 0;\n        return config.direction === 'ascending' ? valA - valB : valB - valA;\n      }\n\n      // Handle string fields\n      const valA = String(a[config.key] || '').toLowerCase();\n      const valB = String(b[config.key] || '').toLowerCase();\n      if (valA < valB) {\n        return config.direction === 'ascending' ? -1 : 1;\n      }\n      if (valA > valB) {\n        return config.direction === 'ascending' ? 1 : -1;\n      }\n      return 0;\n    });\n  };\n\n  // --- Filtered Documents (Memoized) ---\n  const filteredDocuments = useMemo(() => {\n    if (loading || !Array.isArray(documents)) return [];\n    let filtered = documents;\n    if ((user === null || user === void 0 ? void 0 : user.role) === 1) {\n      filtered = selectedWorker !== null ? documents.filter(doc => doc.ID_Worker === selectedWorker) : [];\n    }\n    return sortDocuments(filtered, sortConfig);\n  }, [documents, selectedWorker, user === null || user === void 0 ? void 0 : user.role, loading, sortConfig]);\n\n  // Функция для изменения сортировки\n  const requestSort = key => {\n    let direction = 'ascending';\n    if (sortConfig.key === key && sortConfig.direction === 'ascending') {\n      direction = 'descending';\n    }\n    setSortConfig({\n      key,\n      direction\n    });\n  };\n\n  // Компонент для заголовков с сортировкой\n  const renderSortableHeader = (label, key) => /*#__PURE__*/_jsxDEV(\"th\", {\n    onClick: () => requestSort(key),\n    className: \"sortable-header\",\n    style: {\n      cursor: 'pointer'\n    },\n    children: [label, sortConfig.key === key ? sortConfig.direction === 'ascending' ? ' ▲' : ' ▼' : ' ↕']\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 106,\n    columnNumber: 9\n  }, this);\n\n  // --- Helper Function: Get Worker Name (Memoized) ---\n  const getWorkerName = useCallback(() => {\n    if ((user === null || user === void 0 ? void 0 : user.role) !== 1 || !selectedWorker || !Array.isArray(workers)) return '';\n    const worker = workers.find(w => w.ID_Worker === selectedWorker);\n    return worker ? worker.FName_Worker : `ID ${selectedWorker}`;\n  }, [user === null || user === void 0 ? void 0 : user.role, selectedWorker, workers]);\n  // Загрузка пользователя\n  useEffect(() => {\n    const storedUser = localStorage.getItem('user');\n    if (storedUser) {\n      try {\n        setUser(JSON.parse(storedUser));\n      } catch (e) {\n        console.error(\"Ошибка парсинга пользователя:\", e);\n        localStorage.removeItem('user');\n        setError(\"Ошибка данных пользователя. Пожалуйста, войдите снова.\");\n        setLoading(false);\n      }\n    } else {\n      setError(\"Пользователь не аутентифицирован.\");\n      setLoading(false);\n    }\n  }, []);\n\n  // Загрузка документов\n  const fetchDocuments = useCallback(async () => {\n    if (!user || user.workerId === undefined) {\n      if (user !== null) {\n        setError('Не удалось получить ID пользователя.');\n      }\n      setLoading(false);\n      return;\n    }\n    setLoading(true);\n    setError('');\n    try {\n      const response = await axios.get(`${apiUrl}/api/documents`, {\n        params: {\n          userId: user.workerId,\n          role: user.role\n        }\n      });\n      if (!Array.isArray(response.data)) {\n        throw new Error(\"Неверный формат данных документов.\");\n      }\n      setDocuments(response.data);\n    } catch (err) {\n      var _err$response, _err$response$data;\n      console.error('Ошибка при загрузке документов:', err);\n      setError(((_err$response = err.response) === null || _err$response === void 0 ? void 0 : (_err$response$data = _err$response.data) === null || _err$response$data === void 0 ? void 0 : _err$response$data.error) || 'Ошибка при загрузке документов');\n      setDocuments([]);\n    } finally {\n      setLoading(false);\n    }\n  }, [user, apiUrl]);\n  useEffect(() => {\n    if (user) {\n      fetchDocuments();\n    }\n  }, [user, fetchDocuments]);\n\n  // Отсортированные документы\n  const sortedDocuments = useMemo(() => {\n    return sortDocuments(documents, sortConfig);\n  }, [documents, sortConfig]);\n\n  // Обработчики\n  const handleLogout = () => {\n    localStorage.removeItem('user');\n    navigate('/login');\n  };\n  const handleBack = () => {\n    if (user) {\n      navigate(user.role === 1 ? '/admin' : '/user');\n    } else {\n      navigate('/login');\n    }\n  };\n\n  // Состояния загрузки и ошибок\n  if (user === null && loading) return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"loading\",\n    children: \"\\u0417\\u0430\\u0433\\u0440\\u0443\\u0437\\u043A\\u0430 \\u0434\\u0430\\u043D\\u043D\\u044B\\u0445 \\u043F\\u043E\\u043B\\u044C\\u0437\\u043E\\u0432\\u0430\\u0442\\u0435\\u043B\\u044F...\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 204,\n    columnNumber: 42\n  }, this);\n  if (error) return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"documents-container\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"documents-header\",\n      children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n        children: \"\\u041E\\u0448\\u0438\\u0431\\u043A\\u0430\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 208,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"header-buttons\",\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: handleBack,\n          className: \"back-button\",\n          children: \"\\u041D\\u0430\\u0437\\u0430\\u0434\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 210,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: handleLogout,\n          className: \"logout-button\",\n          children: \"\\u0412\\u044B\\u0439\\u0442\\u0438\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 211,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 209,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 207,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"error\",\n      children: error\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 214,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 206,\n    columnNumber: 9\n  }, this);\n  if (loading) return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"loading\",\n    children: \"\\u0417\\u0430\\u0433\\u0440\\u0443\\u0437\\u043A\\u0430 \\u0434\\u043E\\u043A\\u0443\\u043C\\u0435\\u043D\\u0442\\u043E\\u0432...\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 217,\n    columnNumber: 25\n  }, this);\n  if (!user) return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"error\",\n    children: [\"\\u041D\\u0435 \\u0443\\u0434\\u0430\\u043B\\u043E\\u0441\\u044C \\u0437\\u0430\\u0433\\u0440\\u0443\\u0437\\u0438\\u0442\\u044C \\u0434\\u0430\\u043D\\u043D\\u044B\\u0435 \\u043F\\u043E\\u043B\\u044C\\u0437\\u043E\\u0432\\u0430\\u0442\\u0435\\u043B\\u044F. \", /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: () => navigate('/login'),\n      children: \"\\u0412\\u043E\\u0439\\u0442\\u0438\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 218,\n      columnNumber: 88\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 218,\n    columnNumber: 23\n  }, this);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"documents-container\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"documents-header\",\n      children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n        children: user.role === 1 ? 'Все документы' : 'Мои документы'\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 223,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"header-buttons\",\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: handleBack,\n          className: \"back-button\",\n          children: \"\\u041D\\u0430\\u0437\\u0430\\u0434\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 225,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: handleLogout,\n          className: \"logout-button\",\n          children: \"\\u0412\\u044B\\u0439\\u0442\\u0438\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 226,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 224,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 222,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"documents-list\",\n      children: sortedDocuments.length === 0 ? /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"no-documents\",\n        children: \"\\u0414\\u043E\\u043A\\u0443\\u043C\\u0435\\u043D\\u0442\\u044B \\u043D\\u0435 \\u043D\\u0430\\u0439\\u0434\\u0435\\u043D\\u044B\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 232,\n        columnNumber: 21\n      }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"documents-list\",\n        children: /*#__PURE__*/_jsxDEV(\"table\", {\n          className: \"documents-table\",\n          children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n            children: /*#__PURE__*/_jsxDEV(\"tr\", {\n              children: [renderSortableHeader('Программа обучения', 'ProgramName'), renderSortableHeader('Организация', 'OrgSName'), renderSortableHeader('Рег. номер', 'regnumber'), renderSortableHeader('Дата выдачи', 'DateIssue'), /*#__PURE__*/_jsxDEV(\"th\", {\n                children: \"\\u0414\\u0435\\u0439\\u0441\\u0442\\u0432\\u0438\\u044F\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 242,\n                columnNumber: 33\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 237,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 236,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n            children: filteredDocuments.map(doc => /*#__PURE__*/_jsxDEV(\"tr\", {\n              children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                children: doc.ProgramName || 'N/A'\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 248,\n                columnNumber: 41\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                children: doc.OrgSName || doc.OrgFName || 'N/A'\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 249,\n                columnNumber: 41\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                children: doc.regnumber || 'N/A'\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 250,\n                columnNumber: 41\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                children: formatDate(doc.DateIssue)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 251,\n                columnNumber: 41\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                children: /*#__PURE__*/_jsxDEV(\"button\", {\n                  className: \"details-button\",\n                  onClick: () => openModal(doc),\n                  children: \"\\u0414\\u043E\\u043F\\u043E\\u043B\\u043D\\u0438\\u0442\\u0435\\u043B\\u044C\\u043D\\u043E\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 253,\n                  columnNumber: 45\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 252,\n                columnNumber: 41\n              }, this)]\n            }, doc.ID_Document, true, {\n              fileName: _jsxFileName,\n              lineNumber: 247,\n              columnNumber: 37\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 245,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 235,\n          columnNumber: 25\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 234,\n        columnNumber: 21\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 230,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(Modal, {\n      isOpen: isModalOpen,\n      onRequestClose: closeModal,\n      contentLabel: \"\\u0414\\u0435\\u0442\\u0430\\u043B\\u0438 \\u0434\\u043E\\u043A\\u0443\\u043C\\u0435\\u043D\\u0442\\u0430\" // Accessibility label\n      ,\n      className: \"modal-content\" // Class for styling the modal content\n      ,\n      overlayClassName: \"modal-overlay\" // Class for styling the background overlay\n      ,\n      ariaHideApp: true // Helps with screen readers\n      ,\n      children: selectedDocumentForModal ? /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          children: [\"\\u0414\\u0435\\u0442\\u0430\\u043B\\u0438 \\u0434\\u043E\\u043A\\u0443\\u043C\\u0435\\u043D\\u0442\\u0430 \\u2116 \", selectedDocumentForModal.regnumber || selectedDocumentForModal.ID_Document]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 279,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: closeModal,\n          className: \"modal-close-button\",\n          \"aria-label\": \"\\u0417\\u0430\\u043A\\u0440\\u044B\\u0442\\u044C\",\n          children: \"\\xD7\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 280,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"modal-details-grid\",\n          children: [/*#__PURE__*/_jsxDEV(\"p\", {\n            children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n              children: \"\\u0420\\u0430\\u0431\\u043E\\u0442\\u043D\\u0438\\u043A:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 282,\n              columnNumber: 36\n            }, this), \" \", selectedDocumentForModal.WorkerName || getWorkerName() || 'N/A']\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 282,\n            columnNumber: 33\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n              children: \"\\u041F\\u0440\\u043E\\u0433\\u0440\\u0430\\u043C\\u043C\\u0430 \\u043E\\u0431\\u0443\\u0447\\u0435\\u043D\\u0438\\u044F:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 283,\n              columnNumber: 36\n            }, this), \" \", selectedDocumentForModal.ProgramName || 'N/A']\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 283,\n            columnNumber: 33\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n              children: \"\\u041E\\u0440\\u0433\\u0430\\u043D\\u0438\\u0437\\u0430\\u0446\\u0438\\u044F (\\u043F\\u043E\\u043B\\u043D\\u043E\\u0435):\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 284,\n              columnNumber: 36\n            }, this), \" \", selectedDocumentForModal.OrgFName || 'N/A']\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 284,\n            columnNumber: 33\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n              children: \"\\u041E\\u0440\\u0433\\u0430\\u043D\\u0438\\u0437\\u0430\\u0446\\u0438\\u044F (\\u043A\\u0440\\u0430\\u0442\\u043A\\u043E\\u0435):\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 285,\n              columnNumber: 36\n            }, this), \" \", selectedDocumentForModal.OrgSName || 'N/A']\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 285,\n            columnNumber: 33\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n              children: \"\\u0420\\u0435\\u0433\\u0438\\u0441\\u0442\\u0440\\u0430\\u0446\\u0438\\u043E\\u043D\\u043D\\u044B\\u0439 \\u043D\\u043E\\u043C\\u0435\\u0440:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 286,\n              columnNumber: 36\n            }, this), \" \", selectedDocumentForModal.regnumber || 'N/A']\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 286,\n            columnNumber: 33\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n              children: \"\\u0414\\u0430\\u0442\\u0430 \\u0432\\u044B\\u0434\\u0430\\u0447\\u0438:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 287,\n              columnNumber: 36\n            }, this), \" \", formatDate(selectedDocumentForModal.DateIssue)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 287,\n            columnNumber: 33\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"kks-details\",\n            children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n              children: \"\\u041A\\u0440\\u0438\\u0442\\u0435\\u0440\\u0438\\u0438 \\u041A\\u041A\\u0421:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 289,\n              columnNumber: 37\n            }, this), Array.isArray(selectedDocumentForModal.KKS_Data) && selectedDocumentForModal.KKS_Data.length > 0 ? selectedDocumentForModal.KKS_Data.map(k => k.fullName || k.shortName).filter(Boolean).join(', ') : 'Нет данных']\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 288,\n            columnNumber: 33\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 281,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true) : /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"\\u0417\\u0430\\u0433\\u0440\\u0443\\u0437\\u043A\\u0430 \\u0434\\u0435\\u0442\\u0430\\u043B\\u0435\\u0439...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 300,\n        columnNumber: 21\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 267,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 221,\n    columnNumber: 9\n  }, this);\n}\n_s(Documents, \"EL1S/uteObh6bPXYq3TxtFo7iuk=\", false, function () {\n  return [useNavigate];\n});\n_c = Documents;\nexport default Documents;\nvar _c;\n$RefreshReg$(_c, \"Documents\");","map":{"version":3,"names":["React","useState","useEffect","useMemo","useCallback","axios","useNavigate","Modal","jsxDEV","_jsxDEV","Fragment","_Fragment","apiUrl","process","env","REACT_APP_API_URL","setAppElement","formatDate","dateStr","date","Date","isNaN","getTime","toLocaleDateString","e","console","error","Documents","_s","documents","setDocuments","loading","setLoading","setError","user","setUser","workers","setWorkers","selectedWorker","setSelectedWorker","isModalOpen","setIsModalOpen","selectedDocumentForModal","setSelectedDocumentForModal","sortConfig","setSortConfig","key","direction","navigate","openModal","doc","log","closeModal","sortDocuments","docs","config","sort","a","b","includes","dateA","dateB","valA","valB","String","toLowerCase","filteredDocuments","Array","isArray","filtered","role","filter","ID_Worker","requestSort","renderSortableHeader","label","onClick","className","style","cursor","children","fileName","_jsxFileName","lineNumber","columnNumber","getWorkerName","worker","find","w","FName_Worker","storedUser","localStorage","getItem","JSON","parse","removeItem","fetchDocuments","workerId","undefined","response","get","params","userId","data","Error","err","_err$response","_err$response$data","sortedDocuments","handleLogout","handleBack","length","map","ProgramName","OrgSName","OrgFName","regnumber","DateIssue","ID_Document","isOpen","onRequestClose","contentLabel","overlayClassName","ariaHideApp","WorkerName","KKS_Data","k","fullName","shortName","Boolean","join","_c","$RefreshReg$"],"sources":["D:/Amina/VScode/FQW_new/src/components/Documents.js"],"sourcesContent":["import React, { useState, useEffect, useMemo, useCallback } from 'react';\nimport axios from 'axios';\nimport { useNavigate } from 'react-router-dom';\nimport Modal from 'react-modal';\nimport './Documents.css';\n\nconst apiUrl = process.env.REACT_APP_API_URL;\n\n// Set the app element for react-modal accessibility\nModal.setAppElement('#root'); // Adjust '#root' if your app's root element has a different ID\n\n// Вспомогательная функция для форматирования даты\nconst formatDate = (dateStr) => {\n    if (!dateStr) return 'N/A';\n    try {\n        const date = new Date(dateStr);\n        return isNaN(date.getTime()) ? 'Неверная дата' : date.toLocaleDateString('ru-RU');\n    } catch (e) {\n        console.error(\"Error formatting date:\", dateStr, e);\n        return 'Ошибка даты';\n    }\n};\n\nfunction Documents() {\n    const [documents, setDocuments] = useState([]);\n    const [loading, setLoading] = useState(true);\n    const [error, setError] = useState('');\n    const [user, setUser] = useState(null);\n    const [workers, setWorkers] = useState([]);\n    const [selectedWorker, setSelectedWorker] = useState(null);\n    const [isModalOpen, setIsModalOpen] = useState(false);\n    const [selectedDocumentForModal, setSelectedDocumentForModal] = useState(null);\n    const [sortConfig, setSortConfig] = useState({ key: 'DateIssue', direction: 'descending' });\n    const navigate = useNavigate();\n    // --- Modal Handlers ---\n    const openModal = (doc) => {\n        console.log(\"Opening modal for doc:\", doc);\n        setSelectedDocumentForModal(doc);\n        setIsModalOpen(true);\n    };\n    const closeModal = () => {\n        setIsModalOpen(false);\n        setSelectedDocumentForModal(null); // Clear selected doc when closing\n    };\n// Helper function to sort documents\nconst sortDocuments = (docs, config) => {\n    if (!config.key) return docs;\n    return [...docs].sort((a, b) => {\n        // Handle date fields specially\n        if (['DateIssue', 'DataStart', 'DataEnd'].includes(config.key)) {\n            const dateA = a[config.key] ? new Date(a[config.key]).getTime() : 0;\n            const dateB = b[config.key] ? new Date(b[config.key]).getTime() : 0;\n            if (dateA < dateB) {\n                return config.direction === 'ascending' ? -1 : 1;\n            }\n            if (dateA > dateB) {\n                return config.direction === 'ascending' ? 1 : -1;\n            }\n            return 0;\n        }\n        // Handle numeric fields\n        if (['ID_Document', 'ID_Worker', 'ID_ProgDPO'].includes(config.key)) {\n            const valA = a[config.key] || 0;\n            const valB = b[config.key] || 0;\n            return config.direction === 'ascending' ? valA - valB : valB - valA;\n        }\n        \n        // Handle string fields\n        const valA = String(a[config.key] || '').toLowerCase();\n        const valB = String(b[config.key] || '').toLowerCase();\n        if (valA < valB) {\n            return config.direction === 'ascending' ? -1 : 1;\n        }\n        if (valA > valB) {\n            return config.direction === 'ascending' ? 1 : -1;\n        }\n        return 0;\n    });\n};\n\n// --- Filtered Documents (Memoized) ---\n    const filteredDocuments = useMemo(() => {\n        if (loading || !Array.isArray(documents)) return [];\n    \n        let filtered = documents;\n        if (user?.role === 1) {\n            filtered = selectedWorker !== null\n                ? documents.filter(doc => doc.ID_Worker === selectedWorker)\n                : [];\n        }\n        \n        return sortDocuments(filtered, sortConfig);\n    }, [documents, selectedWorker, user?.role, loading, sortConfig]);\n\n    // Функция для изменения сортировки\n    const requestSort = (key) => {\n        let direction = 'ascending';\n        if (sortConfig.key === key && sortConfig.direction === 'ascending') {\n            direction = 'descending';\n        }\n        setSortConfig({ key, direction });\n    };\n\n    // Компонент для заголовков с сортировкой\n    const renderSortableHeader = (label, key) => (\n        <th \n            onClick={() => requestSort(key)} \n            className=\"sortable-header\"\n            style={{ cursor: 'pointer' }}\n        >\n            {label} \n            {sortConfig.key === key ? (\n                sortConfig.direction === 'ascending' ? ' ▲' : ' ▼'\n            ) : ' ↕'}\n        </th>\n    );\n\n// --- Helper Function: Get Worker Name (Memoized) ---\n    const getWorkerName = useCallback(() => {\n        if (user?.role !== 1 || !selectedWorker || !Array.isArray(workers)) return '';\n        const worker = workers.find(w => w.ID_Worker === selectedWorker);\n        return worker ? worker.FName_Worker : `ID ${selectedWorker}`;\n    }, [user?.role, selectedWorker, workers]);\n    // Загрузка пользователя\n    useEffect(() => {\n        const storedUser = localStorage.getItem('user');\n        if (storedUser) {\n            try {\n                setUser(JSON.parse(storedUser));\n            } catch (e) {\n                console.error(\"Ошибка парсинга пользователя:\", e);\n                localStorage.removeItem('user');\n                setError(\"Ошибка данных пользователя. Пожалуйста, войдите снова.\");\n                setLoading(false);\n            }\n        } else {\n            setError(\"Пользователь не аутентифицирован.\");\n            setLoading(false);\n        }\n    }, []);\n\n    // Загрузка документов\n    const fetchDocuments = useCallback(async () => {\n        if (!user || user.workerId === undefined) {\n            if (user !== null) {\n                setError('Не удалось получить ID пользователя.');\n            }\n            setLoading(false);\n            return;\n        }\n\n        setLoading(true);\n        setError('');\n\n        try {\n            const response = await axios.get(`${apiUrl}/api/documents`, {\n                params: {\n                    userId: user.workerId,\n                    role: user.role\n                }\n            });\n\n            if (!Array.isArray(response.data)) {\n                throw new Error(\"Неверный формат данных документов.\");\n            }\n\n            setDocuments(response.data);\n\n        } catch (err) {\n            console.error('Ошибка при загрузке документов:', err);\n            setError(err.response?.data?.error || 'Ошибка при загрузке документов');\n            setDocuments([]);\n        } finally {\n            setLoading(false);\n        }\n    }, [user, apiUrl]);\n\n    useEffect(() => {\n        if (user) {\n            fetchDocuments();\n        }\n    }, [user, fetchDocuments]);\n\n    // Отсортированные документы\n    const sortedDocuments = useMemo(() => {\n        return sortDocuments(documents, sortConfig);\n    }, [documents, sortConfig]);\n\n    // Обработчики\n    const handleLogout = () => {\n        localStorage.removeItem('user');\n        navigate('/login');\n    };\n\n    const handleBack = () => {\n        if (user) {\n            navigate(user.role === 1 ? '/admin' : '/user');\n        } else {\n            navigate('/login');\n        }\n    };\n\n    // Состояния загрузки и ошибок\n    if (user === null && loading) return <div className=\"loading\">Загрузка данных пользователя...</div>;\n    if (error) return (\n        <div className=\"documents-container\">\n            <div className=\"documents-header\">\n                <h1>Ошибка</h1>\n                <div className=\"header-buttons\">\n                    <button onClick={handleBack} className=\"back-button\">Назад</button>\n                    <button onClick={handleLogout} className=\"logout-button\">Выйти</button>\n                </div>\n            </div>\n            <div className=\"error\">{error}</div>\n        </div>\n    );\n    if (loading) return <div className=\"loading\">Загрузка документов...</div>;\n    if (!user) return <div className=\"error\">Не удалось загрузить данные пользователя. <button onClick={() => navigate('/login')}>Войти</button></div>;\n\n    return (\n        <div className=\"documents-container\">\n            <div className=\"documents-header\">\n                <h1>{user.role === 1 ? 'Все документы' : 'Мои документы'}</h1>\n                <div className=\"header-buttons\">\n                    <button onClick={handleBack} className=\"back-button\">Назад</button>\n                    <button onClick={handleLogout} className=\"logout-button\">Выйти</button>\n                </div>\n            </div>\n\n            <div className=\"documents-list\">\n                {sortedDocuments.length === 0 ? (\n                    <p className=\"no-documents\">Документы не найдены</p>\n                ) : (\n                    <div className=\"documents-list\">\n                        <table className=\"documents-table\">\n                            <thead>\n                            <tr>\n                                {renderSortableHeader('Программа обучения', 'ProgramName')}\n                                {renderSortableHeader('Организация', 'OrgSName')}\n                                {renderSortableHeader('Рег. номер', 'regnumber')}\n                                {renderSortableHeader('Дата выдачи', 'DateIssue')}\n                                <th>Действия</th>\n                            </tr>\n                            </thead>\n                            <tbody>\n                                {filteredDocuments.map((doc) => (\n                                    <tr key={doc.ID_Document}>\n                                        <td>{doc.ProgramName || 'N/A'}</td>\n                                        <td>{doc.OrgSName || doc.OrgFName || 'N/A'}</td>\n                                        <td>{doc.regnumber || 'N/A'}</td>\n                                        <td>{formatDate(doc.DateIssue)}</td>\n                                        <td>\n                                            <button\n                                                className=\"details-button\"\n                                                onClick={() => openModal(doc)}\n                                            >\n                                                Дополнительно\n                                            </button>\n                                        </td>\n                                    </tr>\n                                ))}\n                            </tbody>\n                        </table>\n                     </div>\n                )}\n            </div>\n            <Modal\n                isOpen={isModalOpen}\n                onRequestClose={closeModal}\n                contentLabel=\"Детали документа\" // Accessibility label\n                className=\"modal-content\" // Class for styling the modal content\n                overlayClassName=\"modal-overlay\" // Class for styling the background overlay\n                ariaHideApp={true} // Helps with screen readers\n            >\n                {/* Content inside the modal */}\n                {selectedDocumentForModal ? (\n                    <>\n                        {/* Modal Header */}\n                        <h2>Детали документа № {selectedDocumentForModal.regnumber || selectedDocumentForModal.ID_Document}</h2>\n                        <button onClick={closeModal} className=\"modal-close-button\" aria-label=\"Закрыть\">&times;</button>\n                        <div className=\"modal-details-grid\">\n                                <p><strong>Работник:</strong> {selectedDocumentForModal.WorkerName || getWorkerName() || 'N/A'}</p>\n                                <p><strong>Программа обучения:</strong> {selectedDocumentForModal.ProgramName || 'N/A'}</p>\n                                <p><strong>Организация (полное):</strong> {selectedDocumentForModal.OrgFName || 'N/A'}</p>\n                                <p><strong>Организация (краткое):</strong> {selectedDocumentForModal.OrgSName || 'N/A'}</p>\n                                <p><strong>Регистрационный номер:</strong> {selectedDocumentForModal.regnumber || 'N/A'}</p>\n                                <p><strong>Дата выдачи:</strong> {formatDate(selectedDocumentForModal.DateIssue)}</p>\n                                <p className=\"kks-details\">\n                                    <strong>Критерии ККС:</strong>\n                                    {Array.isArray(selectedDocumentForModal.KKS_Data) && selectedDocumentForModal.KKS_Data.length > 0\n                                        ? selectedDocumentForModal.KKS_Data\n                                            .map(k => k.fullName || k.shortName)\n                                            .filter(Boolean)\n                                            .join(', ')\n                                        : 'Нет данных'}\n                                </p>\n                        </div>\n                    </>\n                ) : (\n                    <p>Загрузка деталей...</p>\n                )}\n            </Modal>\n        </div>\n    );\n}\n\nexport default Documents;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}