{"ast":null,"code":"var _jsxFileName = \"D:\\\\Amina\\\\VScode\\\\FQW_new\\\\src\\\\components\\\\Documents.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useMemo, useCallback } from 'react';\nimport axios from 'axios';\nimport { useNavigate } from 'react-router-dom';\nimport './Documents.css';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst apiUrl = process.env.REACT_APP_API_URL;\n\n// Вспомогательная функция для форматирования даты\nconst formatDate = dateStr => {\n  if (!dateStr) return 'N/A';\n  try {\n    const date = new Date(dateStr);\n    return isNaN(date.getTime()) ? 'Неверная дата' : date.toLocaleDateString('ru-RU');\n  } catch (e) {\n    console.error(\"Error formatting date:\", dateStr, e);\n    return 'Ошибка даты';\n  }\n};\nfunction Documents() {\n  _s();\n  const [documents, setDocuments] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState('');\n  const [user, setUser] = useState(null);\n  const [selectedWorker, setSelectedWorker] = useState(null); // Store worker ID\n  const [isModalOpen, setIsModalOpen] = useState(false);\n  const [selectedDocumentForModal, setSelectedDocumentForModal] = useState(null);\n  const [sortConfig, setSortConfig] = useState({\n    key: 'DateIssue',\n    direction: 'descending'\n  });\n  const navigate = useNavigate();\n\n  // --- Modal Handlers ---\n  const openModal = doc => {\n    console.log(\"Opening modal for doc:\", doc);\n    setSelectedDocumentForModal(doc);\n    setIsModalOpen(true);\n  };\n  const closeModal = () => {\n    setIsModalOpen(false);\n    setSelectedDocumentForModal(null); // Clear selected doc when closing\n  };\n\n  // --- Filtered Documents (Memoized) ---\n  const filteredDocuments = useMemo(() => {\n    if (loading || !Array.isArray(documents)) return [];\n    let filtered = documents;\n    if ((user === null || user === void 0 ? void 0 : user.role) === 1) {\n      filtered = selectedWorker !== null ? documents.filter(doc => doc.ID_Worker === selectedWorker) : [];\n    }\n    return sortDocuments(filtered, sortConfig);\n  }, [documents, selectedWorker, user === null || user === void 0 ? void 0 : user.role, loading, sortConfig]);\n\n  // Функция сортировки документов\n  const sortDocuments = (docs, config) => {\n    if (!config.key || !Array.isArray(docs)) return docs || [];\n    return [...docs].sort((a, b) => {\n      // Сортировка по дате\n      if (['DateIssue', 'DataStart', 'DataEnd'].includes(config.key)) {\n        const dateA = a[config.key] ? new Date(a[config.key]).getTime() : 0;\n        const dateB = b[config.key] ? new Date(b[config.key]).getTime() : 0;\n        if (dateA < dateB) return config.direction === 'ascending' ? -1 : 1;\n        if (dateA > dateB) return config.direction === 'ascending' ? 1 : -1;\n        return 0;\n      }\n\n      // Сортировка по числовым полям\n      if (['ID_Document', 'ID_Worker', 'ID_ProgDPO'].includes(config.key)) {\n        const valA = a[config.key] || 0;\n        const valB = b[config.key] || 0;\n        return config.direction === 'ascending' ? valA - valB : valB - valA;\n      }\n\n      // Сортировка по текстовым полям\n      const valA = String(a[config.key] || '').toLowerCase();\n      const valB = String(b[config.key] || '').toLowerCase();\n      if (valA < valB) return config.direction === 'ascending' ? -1 : 1;\n      if (valA > valB) return config.direction === 'ascending' ? 1 : -1;\n      return 0;\n    });\n  };\n\n  // Функция для изменения сортировки\n  const requestSort = key => {\n    let direction = 'ascending';\n    if (sortConfig.key === key && sortConfig.direction === 'ascending') {\n      direction = 'descending';\n    }\n    setSortConfig({\n      key,\n      direction\n    });\n  };\n\n  // Компонент для заголовков с сортировкой\n  const renderSortableHeader = (label, key) => /*#__PURE__*/_jsxDEV(\"th\", {\n    onClick: () => requestSort(key),\n    className: \"sortable-header\",\n    style: {\n      cursor: 'pointer'\n    },\n    children: [label, sortConfig.key === key ? sortConfig.direction === 'ascending' ? ' ▲' : ' ▼' : ' ↕']\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 98,\n    columnNumber: 9\n  }, this);\n\n  // Загрузка пользователя\n  useEffect(() => {\n    const storedUser = localStorage.getItem('user');\n    if (storedUser) {\n      try {\n        setUser(JSON.parse(storedUser));\n      } catch (e) {\n        console.error(\"Ошибка парсинга пользователя:\", e);\n        localStorage.removeItem('user');\n        setError(\"Ошибка данных пользователя. Пожалуйста, войдите снова.\");\n        setLoading(false);\n      }\n    } else {\n      setError(\"Пользователь не аутентифицирован.\");\n      setLoading(false);\n    }\n  }, []);\n\n  // Загрузка документов\n  const fetchDocuments = useCallback(async () => {\n    if (!user || user.workerId === undefined) {\n      if (user !== null) {\n        setError('Не удалось получить ID пользователя.');\n      }\n      setLoading(false);\n      return;\n    }\n    setLoading(true);\n    setError('');\n    try {\n      const response = await axios.get(`${apiUrl}/api/documents`, {\n        params: {\n          userId: user.workerId,\n          role: user.role\n        }\n      });\n      if (!Array.isArray(response.data)) {\n        throw new Error(\"Неверный формат данных документов.\");\n      }\n      setDocuments(response.data);\n    } catch (err) {\n      var _err$response, _err$response$data;\n      console.error('Ошибка при загрузке документов:', err);\n      setError(((_err$response = err.response) === null || _err$response === void 0 ? void 0 : (_err$response$data = _err$response.data) === null || _err$response$data === void 0 ? void 0 : _err$response$data.error) || 'Ошибка при загрузке документов');\n      setDocuments([]);\n    } finally {\n      setLoading(false);\n    }\n  }, [user, apiUrl]);\n  useEffect(() => {\n    if (user) {\n      fetchDocuments();\n    }\n  }, [user, fetchDocuments]);\n\n  // Отсортированные документы\n  const sortedDocuments = useMemo(() => {\n    return sortDocuments(documents, sortConfig);\n  }, [documents, sortConfig]);\n\n  // Обработчики\n  const handleLogout = () => {\n    localStorage.removeItem('user');\n    navigate('/login');\n  };\n  const handleBack = () => {\n    if (user) {\n      navigate(user.role === 1 ? '/admin' : '/user');\n    } else {\n      navigate('/login');\n    }\n  };\n\n  // Состояния загрузки и ошибок\n  if (user === null && loading) return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"loading\",\n    children: \"\\u0417\\u0430\\u0433\\u0440\\u0443\\u0437\\u043A\\u0430 \\u0434\\u0430\\u043D\\u043D\\u044B\\u0445 \\u043F\\u043E\\u043B\\u044C\\u0437\\u043E\\u0432\\u0430\\u0442\\u0435\\u043B\\u044F...\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 190,\n    columnNumber: 42\n  }, this);\n  if (error) return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"documents-container\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"documents-header\",\n      children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n        children: \"\\u041E\\u0448\\u0438\\u0431\\u043A\\u0430\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 194,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"header-buttons\",\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: handleBack,\n          className: \"back-button\",\n          children: \"\\u041D\\u0430\\u0437\\u0430\\u0434\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 196,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: handleLogout,\n          className: \"logout-button\",\n          children: \"\\u0412\\u044B\\u0439\\u0442\\u0438\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 197,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 195,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 193,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"error\",\n      children: error\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 200,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 192,\n    columnNumber: 9\n  }, this);\n  if (loading) return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"loading\",\n    children: \"\\u0417\\u0430\\u0433\\u0440\\u0443\\u0437\\u043A\\u0430 \\u0434\\u043E\\u043A\\u0443\\u043C\\u0435\\u043D\\u0442\\u043E\\u0432...\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 203,\n    columnNumber: 25\n  }, this);\n  if (!user) return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"error\",\n    children: [\"\\u041D\\u0435 \\u0443\\u0434\\u0430\\u043B\\u043E\\u0441\\u044C \\u0437\\u0430\\u0433\\u0440\\u0443\\u0437\\u0438\\u0442\\u044C \\u0434\\u0430\\u043D\\u043D\\u044B\\u0435 \\u043F\\u043E\\u043B\\u044C\\u0437\\u043E\\u0432\\u0430\\u0442\\u0435\\u043B\\u044F. \", /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: () => navigate('/login'),\n      children: \"\\u0412\\u043E\\u0439\\u0442\\u0438\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 204,\n      columnNumber: 88\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 204,\n    columnNumber: 23\n  }, this);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"documents-container\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"documents-header\",\n      children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n        children: user.role === 1 ? 'Все документы' : 'Мои документы'\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 209,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"header-buttons\",\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: handleBack,\n          className: \"back-button\",\n          children: \"\\u041D\\u0430\\u0437\\u0430\\u0434\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 211,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: handleLogout,\n          className: \"logout-button\",\n          children: \"\\u0412\\u044B\\u0439\\u0442\\u0438\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 212,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 210,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 208,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"documents-list\",\n      children: sortedDocuments.length === 0 ? /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"no-documents\",\n        children: \"\\u0414\\u043E\\u043A\\u0443\\u043C\\u0435\\u043D\\u0442\\u044B \\u043D\\u0435 \\u043D\\u0430\\u0439\\u0434\\u0435\\u043D\\u044B\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 218,\n        columnNumber: 21\n      }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"documents-list\",\n        children: /*#__PURE__*/_jsxDEV(\"table\", {\n          className: \"documents-table\",\n          children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n            children: /*#__PURE__*/_jsxDEV(\"tr\", {\n              children: [renderSortableHeader('Программа обучения', 'ProgramName'), renderSortableHeader('Организация', 'OrgSName'), renderSortableHeader('Рег. номер', 'regnumber'), renderSortableHeader('Дата выдачи', 'DateIssue'), /*#__PURE__*/_jsxDEV(\"th\", {\n                children: \"\\u0414\\u0435\\u0439\\u0441\\u0442\\u0432\\u0438\\u044F\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 229,\n                columnNumber: 33\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 223,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 222,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n            children: filteredDocuments.map(doc => /*#__PURE__*/_jsxDEV(\"tr\", {\n              children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                children: doc.ProgramName || 'N/A'\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 236,\n                columnNumber: 41\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                children: doc.OrgSName || doc.OrgFName || 'N/A'\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 237,\n                columnNumber: 41\n              }, this), \" \", /*#__PURE__*/_jsxDEV(\"td\", {\n                children: doc.regnumber || 'N/A'\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 238,\n                columnNumber: 41\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                children: formatDate(doc.DateIssue)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 239,\n                columnNumber: 41\n              }, this), \" \", /*#__PURE__*/_jsxDEV(\"td\", {\n                children: /*#__PURE__*/_jsxDEV(\"button\", {\n                  className: \"details-button\",\n                  onClick: () => openModal(doc) // Pass the whole document object\n                  ,\n                  children: \"\\u0414\\u043E\\u043F\\u043E\\u043B\\u043D\\u0438\\u0442\\u0435\\u043B\\u044C\\u043D\\u043E\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 242,\n                  columnNumber: 45\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 240,\n                columnNumber: 41\n              }, this)]\n            }, doc.ID_Document, true, {\n              fileName: _jsxFileName,\n              lineNumber: 234,\n              columnNumber: 37\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 232,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 221,\n          columnNumber: 25\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 220,\n        columnNumber: 21\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 216,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(Modal, {\n      isOpen: isModalOpen,\n      onRequestClose: closeModal,\n      contentLabel: \"\\u0414\\u0435\\u0442\\u0430\\u043B\\u0438 \\u0434\\u043E\\u043A\\u0443\\u043C\\u0435\\u043D\\u0442\\u0430\" // Accessibility label\n      ,\n      className: \"modal-content\" // Class for styling the modal content\n      ,\n      overlayClassName: \"modal-overlay\" // Class for styling the background overlay\n      ,\n      ariaHideApp: true // Helps with screen readers\n      ,\n      children: selectedDocumentForModal ? /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          children: [\"\\u0414\\u0435\\u0442\\u0430\\u043B\\u0438 \\u0434\\u043E\\u043A\\u0443\\u043C\\u0435\\u043D\\u0442\\u0430 \\u2116 \", selectedDocumentForModal.regnumber || selectedDocumentForModal.ID_Document]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 269,\n          columnNumber: 37\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: closeModal,\n          className: \"modal-close-button\",\n          \"aria-label\": \"\\u0417\\u0430\\u043A\\u0440\\u044B\\u0442\\u044C\",\n          children: \"\\xD7\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 270,\n          columnNumber: 37\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"modal-details-grid\",\n          children: [/*#__PURE__*/_jsxDEV(\"p\", {\n            children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n              children: \"\\u0420\\u0430\\u0431\\u043E\\u0442\\u043D\\u0438\\u043A:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 275,\n              columnNumber: 46\n            }, this), \" \", selectedDocumentForModal.WorkerName || getWorkerName() || 'N/A']\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 275,\n            columnNumber: 43\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n              children: \"\\u041F\\u0440\\u043E\\u0433\\u0440\\u0430\\u043C\\u043C\\u0430 \\u043E\\u0431\\u0443\\u0447\\u0435\\u043D\\u0438\\u044F:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 276,\n              columnNumber: 46\n            }, this), \" \", selectedDocumentForModal.ProgramName || 'N/A']\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 276,\n            columnNumber: 43\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n              children: \"\\u041E\\u0440\\u0433\\u0430\\u043D\\u0438\\u0437\\u0430\\u0446\\u0438\\u044F (\\u043F\\u043E\\u043B\\u043D\\u043E\\u0435):\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 277,\n              columnNumber: 46\n            }, this), \" \", selectedDocumentForModal.OrgFName || 'N/A']\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 277,\n            columnNumber: 43\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n              children: \"\\u041E\\u0440\\u0433\\u0430\\u043D\\u0438\\u0437\\u0430\\u0446\\u0438\\u044F (\\u043A\\u0440\\u0430\\u0442\\u043A\\u043E\\u0435):\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 278,\n              columnNumber: 46\n            }, this), \" \", selectedDocumentForModal.OrgSName || 'N/A']\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 278,\n            columnNumber: 43\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n              children: \"\\u0420\\u0435\\u0433\\u0438\\u0441\\u0442\\u0440\\u0430\\u0446\\u0438\\u043E\\u043D\\u043D\\u044B\\u0439 \\u043D\\u043E\\u043C\\u0435\\u0440:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 279,\n              columnNumber: 46\n            }, this), \" \", selectedDocumentForModal.regnumber || 'N/A']\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 279,\n            columnNumber: 43\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n              children: \"\\u0414\\u0430\\u0442\\u0430 \\u0432\\u044B\\u0434\\u0430\\u0447\\u0438:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 280,\n              columnNumber: 46\n            }, this), \" \", formatDate(selectedDocumentForModal.DateIssue)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 280,\n            columnNumber: 43\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"kks-details\",\n            children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n              children: \"\\u041A\\u0440\\u0438\\u0442\\u0435\\u0440\\u0438\\u0438 \\u041A\\u041A\\u0421:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 285,\n              columnNumber: 46\n            }, this), Array.isArray(selectedDocumentForModal.KKS_Data) && selectedDocumentForModal.KKS_Data.length > 0 ? selectedDocumentForModal.KKS_Data.map(k => k.fullName || k.shortName) // Prefer full name, fallback to short\n            .filter(Boolean) // Remove any null/empty values\n            .join(', ') // Join with comma and space\n            : 'Нет данных', \" \"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 284,\n            columnNumber: 42\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 273,\n          columnNumber: 37\n        }, this)]\n      }, void 0, true) :\n      /*#__PURE__*/\n      // Fallback message if modal opens before data is ready (shouldn't usually happen)\n      _jsxDEV(\"p\", {\n        children: \"\\u0417\\u0430\\u0433\\u0440\\u0443\\u0437\\u043A\\u0430 \\u0434\\u0435\\u0442\\u0430\\u043B\\u0435\\u0439...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 298,\n        columnNumber: 33\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 257,\n      columnNumber: 25\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 207,\n    columnNumber: 9\n  }, this);\n}\n_s(Documents, \"stzbzzoda5UP06Bc8rVs1u93rMQ=\", false, function () {\n  return [useNavigate];\n});\n_c = Documents;\nexport default Documents;\nvar _c;\n$RefreshReg$(_c, \"Documents\");","map":{"version":3,"names":["React","useState","useEffect","useMemo","useCallback","axios","useNavigate","jsxDEV","_jsxDEV","Fragment","_Fragment","apiUrl","process","env","REACT_APP_API_URL","formatDate","dateStr","date","Date","isNaN","getTime","toLocaleDateString","e","console","error","Documents","_s","documents","setDocuments","loading","setLoading","setError","user","setUser","selectedWorker","setSelectedWorker","isModalOpen","setIsModalOpen","selectedDocumentForModal","setSelectedDocumentForModal","sortConfig","setSortConfig","key","direction","navigate","openModal","doc","log","closeModal","filteredDocuments","Array","isArray","filtered","role","filter","ID_Worker","sortDocuments","docs","config","sort","a","b","includes","dateA","dateB","valA","valB","String","toLowerCase","requestSort","renderSortableHeader","label","onClick","className","style","cursor","children","fileName","_jsxFileName","lineNumber","columnNumber","storedUser","localStorage","getItem","JSON","parse","removeItem","fetchDocuments","workerId","undefined","response","get","params","userId","data","Error","err","_err$response","_err$response$data","sortedDocuments","handleLogout","handleBack","length","map","ProgramName","OrgSName","OrgFName","regnumber","DateIssue","ID_Document","Modal","isOpen","onRequestClose","contentLabel","overlayClassName","ariaHideApp","WorkerName","getWorkerName","KKS_Data","k","fullName","shortName","Boolean","join","_c","$RefreshReg$"],"sources":["D:/Amina/VScode/FQW_new/src/components/Documents.js"],"sourcesContent":["import React, { useState, useEffect, useMemo, useCallback } from 'react';\nimport axios from 'axios';\nimport { useNavigate } from 'react-router-dom';\nimport './Documents.css';\n\nconst apiUrl = process.env.REACT_APP_API_URL;\n\n// Вспомогательная функция для форматирования даты\nconst formatDate = (dateStr) => {\n    if (!dateStr) return 'N/A';\n    try {\n        const date = new Date(dateStr);\n        return isNaN(date.getTime()) ? 'Неверная дата' : date.toLocaleDateString('ru-RU');\n    } catch (e) {\n        console.error(\"Error formatting date:\", dateStr, e);\n        return 'Ошибка даты';\n    }\n};\n\nfunction Documents() {\n    const [documents, setDocuments] = useState([]);\n    const [loading, setLoading] = useState(true);\n    const [error, setError] = useState('');\n    const [user, setUser] = useState(null);\n    const [selectedWorker, setSelectedWorker] = useState(null); // Store worker ID\n    const [isModalOpen, setIsModalOpen] = useState(false);\n    const [selectedDocumentForModal, setSelectedDocumentForModal] = useState(null);\n    const [sortConfig, setSortConfig] = useState({ key: 'DateIssue', direction: 'descending' });\n    const navigate = useNavigate();\n\n    // --- Modal Handlers ---\n    const openModal = (doc) => {\n        console.log(\"Opening modal for doc:\", doc);\n        setSelectedDocumentForModal(doc);\n        setIsModalOpen(true);\n    };\n\n    const closeModal = () => {\n        setIsModalOpen(false);\n        setSelectedDocumentForModal(null); // Clear selected doc when closing\n    };\n\n// --- Filtered Documents (Memoized) ---\n    const filteredDocuments = useMemo(() => {\n        if (loading || !Array.isArray(documents)) return [];\n    \n        let filtered = documents;\n        if (user?.role === 1) {\n            filtered = selectedWorker !== null\n                ? documents.filter(doc => doc.ID_Worker === selectedWorker)\n                : [];\n        }\n        \n        return sortDocuments(filtered, sortConfig);\n    }, [documents, selectedWorker, user?.role, loading, sortConfig]);\n\n    // Функция сортировки документов\n    const sortDocuments = (docs, config) => {\n        if (!config.key || !Array.isArray(docs)) return docs || [];\n        \n        return [...docs].sort((a, b) => {\n            // Сортировка по дате\n            if (['DateIssue', 'DataStart', 'DataEnd'].includes(config.key)) {\n                const dateA = a[config.key] ? new Date(a[config.key]).getTime() : 0;\n                const dateB = b[config.key] ? new Date(b[config.key]).getTime() : 0;\n                if (dateA < dateB) return config.direction === 'ascending' ? -1 : 1;\n                if (dateA > dateB) return config.direction === 'ascending' ? 1 : -1;\n                return 0;\n            }\n            \n            // Сортировка по числовым полям\n            if (['ID_Document', 'ID_Worker', 'ID_ProgDPO'].includes(config.key)) {\n                const valA = a[config.key] || 0;\n                const valB = b[config.key] || 0;\n                return config.direction === 'ascending' ? valA - valB : valB - valA;\n            }\n            \n            // Сортировка по текстовым полям\n            const valA = String(a[config.key] || '').toLowerCase();\n            const valB = String(b[config.key] || '').toLowerCase();\n            if (valA < valB) return config.direction === 'ascending' ? -1 : 1;\n            if (valA > valB) return config.direction === 'ascending' ? 1 : -1;\n            return 0;\n        });\n    };\n\n    // Функция для изменения сортировки\n    const requestSort = (key) => {\n        let direction = 'ascending';\n        if (sortConfig.key === key && sortConfig.direction === 'ascending') {\n            direction = 'descending';\n        }\n        setSortConfig({ key, direction });\n    };\n\n    // Компонент для заголовков с сортировкой\n    const renderSortableHeader = (label, key) => (\n        <th \n            onClick={() => requestSort(key)} \n            className=\"sortable-header\"\n            style={{ cursor: 'pointer' }}\n        >\n            {label} \n            {sortConfig.key === key ? (\n                sortConfig.direction === 'ascending' ? ' ▲' : ' ▼'\n            ) : ' ↕'}\n        </th>\n    );\n\n    // Загрузка пользователя\n    useEffect(() => {\n        const storedUser = localStorage.getItem('user');\n        if (storedUser) {\n            try {\n                setUser(JSON.parse(storedUser));\n            } catch (e) {\n                console.error(\"Ошибка парсинга пользователя:\", e);\n                localStorage.removeItem('user');\n                setError(\"Ошибка данных пользователя. Пожалуйста, войдите снова.\");\n                setLoading(false);\n            }\n        } else {\n            setError(\"Пользователь не аутентифицирован.\");\n            setLoading(false);\n        }\n    }, []);\n\n    // Загрузка документов\n    const fetchDocuments = useCallback(async () => {\n        if (!user || user.workerId === undefined) {\n            if (user !== null) {\n                setError('Не удалось получить ID пользователя.');\n            }\n            setLoading(false);\n            return;\n        }\n\n        setLoading(true);\n        setError('');\n\n        try {\n            const response = await axios.get(`${apiUrl}/api/documents`, {\n                params: {\n                    userId: user.workerId,\n                    role: user.role\n                }\n            });\n\n            if (!Array.isArray(response.data)) {\n                throw new Error(\"Неверный формат данных документов.\");\n            }\n\n            setDocuments(response.data);\n\n        } catch (err) {\n            console.error('Ошибка при загрузке документов:', err);\n            setError(err.response?.data?.error || 'Ошибка при загрузке документов');\n            setDocuments([]);\n        } finally {\n            setLoading(false);\n        }\n    }, [user, apiUrl]);\n\n    useEffect(() => {\n        if (user) {\n            fetchDocuments();\n        }\n    }, [user, fetchDocuments]);\n\n    // Отсортированные документы\n    const sortedDocuments = useMemo(() => {\n        return sortDocuments(documents, sortConfig);\n    }, [documents, sortConfig]);\n\n    // Обработчики\n    const handleLogout = () => {\n        localStorage.removeItem('user');\n        navigate('/login');\n    };\n\n    const handleBack = () => {\n        if (user) {\n            navigate(user.role === 1 ? '/admin' : '/user');\n        } else {\n            navigate('/login');\n        }\n    };\n\n    // Состояния загрузки и ошибок\n    if (user === null && loading) return <div className=\"loading\">Загрузка данных пользователя...</div>;\n    if (error) return (\n        <div className=\"documents-container\">\n            <div className=\"documents-header\">\n                <h1>Ошибка</h1>\n                <div className=\"header-buttons\">\n                    <button onClick={handleBack} className=\"back-button\">Назад</button>\n                    <button onClick={handleLogout} className=\"logout-button\">Выйти</button>\n                </div>\n            </div>\n            <div className=\"error\">{error}</div>\n        </div>\n    );\n    if (loading) return <div className=\"loading\">Загрузка документов...</div>;\n    if (!user) return <div className=\"error\">Не удалось загрузить данные пользователя. <button onClick={() => navigate('/login')}>Войти</button></div>;\n\n    return (\n        <div className=\"documents-container\">\n            <div className=\"documents-header\">\n                <h1>{user.role === 1 ? 'Все документы' : 'Мои документы'}</h1>\n                <div className=\"header-buttons\">\n                    <button onClick={handleBack} className=\"back-button\">Назад</button>\n                    <button onClick={handleLogout} className=\"logout-button\">Выйти</button>\n                </div>\n            </div>\n\n            <div className=\"documents-list\">\n                {sortedDocuments.length === 0 ? (\n                    <p className=\"no-documents\">Документы не найдены</p>\n                ) : (\n                    <div className=\"documents-list\">\n                        <table className=\"documents-table\">\n                            <thead>\n                            <tr>\n                                {/* Show Worker column only for Admin */}\n                                {renderSortableHeader('Программа обучения', 'ProgramName')}\n                                {renderSortableHeader('Организация', 'OrgSName')}\n                                {renderSortableHeader('Рег. номер', 'regnumber')}\n                                {renderSortableHeader('Дата выдачи', 'DateIssue')}\n                                <th>Действия</th>\n                            </tr>\n                            </thead>\n                            <tbody>\n                                {filteredDocuments.map((doc) => (\n                                    <tr key={doc.ID_Document}>\n                                        {/* Document Details cells */}\n                                        <td>{doc.ProgramName || 'N/A'}</td>\n                                        <td>{doc.OrgSName || doc.OrgFName || 'N/A'}</td> {/* Display Short name, fallback to Full */}\n                                        <td>{doc.regnumber || 'N/A'}</td>\n                                        <td>{formatDate(doc.DateIssue)}</td> {/* Use formatted date */}\n                                        <td>\n                                            {/* Button to open the modal */}\n                                            <button\n                                                className=\"details-button\"\n                                                onClick={() => openModal(doc)} // Pass the whole document object\n                                            >\n                                                Дополнительно\n                                            </button>\n                                        </td>\n                                    </tr>\n                                ))}\n                            </tbody>\n                        </table>\n                     </div>\n                )}\n            </div>\n            {/* Modal Definition */}\n                        <Modal\n                            isOpen={isModalOpen}\n                            onRequestClose={closeModal}\n                            contentLabel=\"Детали документа\" // Accessibility label\n                            className=\"modal-content\" // Class for styling the modal content\n                            overlayClassName=\"modal-overlay\" // Class for styling the background overlay\n                            ariaHideApp={true} // Helps with screen readers\n                        >\n                            {/* Content inside the modal */}\n                            {selectedDocumentForModal ? (\n                                <>\n                                    {/* Modal Header */}\n                                    <h2>Детали документа № {selectedDocumentForModal.regnumber || selectedDocumentForModal.ID_Document}</h2>\n                                    <button onClick={closeModal} className=\"modal-close-button\" aria-label=\"Закрыть\">&times;</button>\n            \n                                    {/* Modal Body with Details */}\n                                    <div className=\"modal-details-grid\">\n                                         {/* Display various document details */}\n                                          <p><strong>Работник:</strong> {selectedDocumentForModal.WorkerName || getWorkerName() || 'N/A'}</p>\n                                          <p><strong>Программа обучения:</strong> {selectedDocumentForModal.ProgramName || 'N/A'}</p>\n                                          <p><strong>Организация (полное):</strong> {selectedDocumentForModal.OrgFName || 'N/A'}</p>\n                                          <p><strong>Организация (краткое):</strong> {selectedDocumentForModal.OrgSName || 'N/A'}</p>\n                                          <p><strong>Регистрационный номер:</strong> {selectedDocumentForModal.regnumber || 'N/A'}</p>\n                                          <p><strong>Дата выдачи:</strong> {formatDate(selectedDocumentForModal.DateIssue)}</p>\n                                          {/* Add any other relevant fields from your 'doc' object */}\n            \n                                          {/* Display KKS Criteria */}\n                                         <p className=\"kks-details\">\n                                             <strong>Критерии ККС:</strong>\n                                             {/* Check if KKS_Data is an array and has items */}\n                                              {Array.isArray(selectedDocumentForModal.KKS_Data) && selectedDocumentForModal.KKS_Data.length > 0\n                                                  ? selectedDocumentForModal.KKS_Data\n                                                        .map(k => k.fullName || k.shortName) // Prefer full name, fallback to short\n                                                        .filter(Boolean) // Remove any null/empty values\n                                                        .join(', ') // Join with comma and space\n                                                  : 'Нет данных'} {/* Message if no KKS data or not an array */}\n                                         </p>\n                                    </div>\n                                </>\n                            ) : (\n                                 // Fallback message if modal opens before data is ready (shouldn't usually happen)\n                                <p>Загрузка деталей...</p>\n                            )}\n                        </Modal>\n        </div>\n    );\n}\n\nexport default Documents;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}