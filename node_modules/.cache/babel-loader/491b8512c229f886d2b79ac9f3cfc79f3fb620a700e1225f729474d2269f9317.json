{"ast":null,"code":"var _jsxFileName = \"D:\\\\Amina\\\\VScode\\\\FQW_new\\\\src\\\\components\\\\Documents.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useMemo, useCallback } from 'react';\nimport axios from 'axios';\nimport { useNavigate } from 'react-router-dom';\nimport './Documents.css';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst apiUrl = process.env.REACT_APP_API_URL;\n\n// Вспомогательная функция для форматирования даты\nconst formatDate = dateStr => {\n  if (!dateStr) return 'N/A';\n  try {\n    const date = new Date(dateStr);\n    return isNaN(date.getTime()) ? 'Неверная дата' : date.toLocaleDateString('ru-RU');\n  } catch (e) {\n    console.error(\"Error formatting date:\", dateStr, e);\n    return 'Ошибка даты';\n  }\n};\nfunction Documents() {\n  _s();\n  const [documents, setDocuments] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState('');\n  const [user, setUser] = useState(null);\n  const [isModalOpen, setIsModalOpen] = useState(false);\n  const [selectedDocumentForModal, setSelectedDocumentForModal] = useState(null);\n  const [sortConfig, setSortConfig] = useState({\n    key: 'DateIssue',\n    direction: 'descending'\n  });\n  const navigate = useNavigate();\n\n  // Функция сортировки документов\n  const sortDocuments = (docs, config) => {\n    if (!config.key || !Array.isArray(docs)) return docs || [];\n    return [...docs].sort((a, b) => {\n      // Сортировка по дате\n      if (['DateIssue', 'DataStart', 'DataEnd'].includes(config.key)) {\n        const dateA = a[config.key] ? new Date(a[config.key]).getTime() : 0;\n        const dateB = b[config.key] ? new Date(b[config.key]).getTime() : 0;\n        if (dateA < dateB) return config.direction === 'ascending' ? -1 : 1;\n        if (dateA > dateB) return config.direction === 'ascending' ? 1 : -1;\n        return 0;\n      }\n\n      // Сортировка по числовым полям\n      if (['ID_Document', 'ID_Worker', 'ID_ProgDPO'].includes(config.key)) {\n        const valA = a[config.key] || 0;\n        const valB = b[config.key] || 0;\n        return config.direction === 'ascending' ? valA - valB : valB - valA;\n      }\n\n      // Сортировка по текстовым полям\n      const valA = String(a[config.key] || '').toLowerCase();\n      const valB = String(b[config.key] || '').toLowerCase();\n      if (valA < valB) return config.direction === 'ascending' ? -1 : 1;\n      if (valA > valB) return config.direction === 'ascending' ? 1 : -1;\n      return 0;\n    });\n  };\n\n  // Функция для изменения сортировки\n  const requestSort = key => {\n    let direction = 'ascending';\n    if (sortConfig.key === key && sortConfig.direction === 'ascending') {\n      direction = 'descending';\n    }\n    setSortConfig({\n      key,\n      direction\n    });\n  };\n\n  // Компонент для заголовков с сортировкой\n  const renderSortableHeader = (label, key) => /*#__PURE__*/_jsxDEV(\"th\", {\n    onClick: () => requestSort(key),\n    className: \"sortable-header\",\n    style: {\n      cursor: 'pointer'\n    },\n    children: [label, sortConfig.key === key ? sortConfig.direction === 'ascending' ? ' ▲' : ' ▼' : ' ↕']\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 71,\n    columnNumber: 9\n  }, this);\n\n  // Загрузка пользователя\n  useEffect(() => {\n    const storedUser = localStorage.getItem('user');\n    if (storedUser) {\n      try {\n        setUser(JSON.parse(storedUser));\n      } catch (e) {\n        console.error(\"Ошибка парсинга пользователя:\", e);\n        localStorage.removeItem('user');\n        setError(\"Ошибка данных пользователя. Пожалуйста, войдите снова.\");\n        setLoading(false);\n      }\n    } else {\n      setError(\"Пользователь не аутентифицирован.\");\n      setLoading(false);\n    }\n  }, []);\n\n  // Загрузка документов\n  const fetchDocuments = useCallback(async () => {\n    if (!user || user.workerId === undefined) {\n      if (user !== null) {\n        setError('Не удалось получить ID пользователя.');\n      }\n      setLoading(false);\n      return;\n    }\n    setLoading(true);\n    setError('');\n    try {\n      const response = await axios.get(`${apiUrl}/api/documents`, {\n        params: {\n          userId: user.workerId,\n          role: user.role\n        }\n      });\n      if (!Array.isArray(response.data)) {\n        throw new Error(\"Неверный формат данных документов.\");\n      }\n      setDocuments(response.data);\n    } catch (err) {\n      var _err$response, _err$response$data;\n      console.error('Ошибка при загрузке документов:', err);\n      setError(((_err$response = err.response) === null || _err$response === void 0 ? void 0 : (_err$response$data = _err$response.data) === null || _err$response$data === void 0 ? void 0 : _err$response$data.error) || 'Ошибка при загрузке документов');\n      setDocuments([]);\n    } finally {\n      setLoading(false);\n    }\n  }, [user, apiUrl]);\n  useEffect(() => {\n    if (user) {\n      fetchDocuments();\n    }\n  }, [user, fetchDocuments]);\n\n  // Отсортированные документы\n  const sortedDocuments = useMemo(() => {\n    return sortDocuments(documents, sortConfig);\n  }, [documents, sortConfig]);\n\n  // Обработчики\n  const handleLogout = () => {\n    localStorage.removeItem('user');\n    navigate('/login');\n  };\n  const handleBack = () => {\n    if (user) {\n      navigate(user.role === 1 ? '/admin' : '/user');\n    } else {\n      navigate('/login');\n    }\n  };\n\n  // Состояния загрузки и ошибок\n  if (user === null && loading) return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"loading\",\n    children: \"\\u0417\\u0430\\u0433\\u0440\\u0443\\u0437\\u043A\\u0430 \\u0434\\u0430\\u043D\\u043D\\u044B\\u0445 \\u043F\\u043E\\u043B\\u044C\\u0437\\u043E\\u0432\\u0430\\u0442\\u0435\\u043B\\u044F...\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 163,\n    columnNumber: 42\n  }, this);\n  if (error) return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"documents-container\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"documents-header\",\n      children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n        children: \"\\u041E\\u0448\\u0438\\u0431\\u043A\\u0430\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 167,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"header-buttons\",\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: handleBack,\n          className: \"back-button\",\n          children: \"\\u041D\\u0430\\u0437\\u0430\\u0434\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 169,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: handleLogout,\n          className: \"logout-button\",\n          children: \"\\u0412\\u044B\\u0439\\u0442\\u0438\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 170,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 168,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 166,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"error\",\n      children: error\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 173,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 165,\n    columnNumber: 9\n  }, this);\n  if (loading) return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"loading\",\n    children: \"\\u0417\\u0430\\u0433\\u0440\\u0443\\u0437\\u043A\\u0430 \\u0434\\u043E\\u043A\\u0443\\u043C\\u0435\\u043D\\u0442\\u043E\\u0432...\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 176,\n    columnNumber: 25\n  }, this);\n  if (!user) return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"error\",\n    children: [\"\\u041D\\u0435 \\u0443\\u0434\\u0430\\u043B\\u043E\\u0441\\u044C \\u0437\\u0430\\u0433\\u0440\\u0443\\u0437\\u0438\\u0442\\u044C \\u0434\\u0430\\u043D\\u043D\\u044B\\u0435 \\u043F\\u043E\\u043B\\u044C\\u0437\\u043E\\u0432\\u0430\\u0442\\u0435\\u043B\\u044F. \", /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: () => navigate('/login'),\n      children: \"\\u0412\\u043E\\u0439\\u0442\\u0438\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 177,\n      columnNumber: 88\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 177,\n    columnNumber: 23\n  }, this);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"documents-container\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"documents-header\",\n      children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n        children: user.role === 1 ? 'Все документы' : 'Мои документы'\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 182,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"header-buttons\",\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: handleBack,\n          className: \"back-button\",\n          children: \"\\u041D\\u0430\\u0437\\u0430\\u0434\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 184,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: handleLogout,\n          className: \"logout-button\",\n          children: \"\\u0412\\u044B\\u0439\\u0442\\u0438\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 185,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 183,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 181,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"documents-list\",\n      children: sortedDocuments.length === 0 ? /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"no-documents\",\n        children: \"\\u0414\\u043E\\u043A\\u0443\\u043C\\u0435\\u043D\\u0442\\u044B \\u043D\\u0435 \\u043D\\u0430\\u0439\\u0434\\u0435\\u043D\\u044B\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 191,\n        columnNumber: 21\n      }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"documents-list\",\n        children: (user.role !== 1 || selectedWorker !== null) && filteredDocuments.length > 0 ? /*#__PURE__*/_jsxDEV(\"table\", {\n          className: \"documents-table\",\n          children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n            children: /*#__PURE__*/_jsxDEV(\"tr\", {\n              children: [renderSortableHeader('Программа обучения', 'ProgramName'), renderSortableHeader('Организация', 'OrgSName'), renderSortableHeader('Рег. номер', 'regnumber'), renderSortableHeader('Дата выдачи', 'DateIssue'), /*#__PURE__*/_jsxDEV(\"th\", {\n                children: \"\\u0414\\u0435\\u0439\\u0441\\u0442\\u0432\\u0438\\u044F\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 204,\n                columnNumber: 41\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 198,\n              columnNumber: 37\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 197,\n            columnNumber: 35\n          }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n            children: filteredDocuments.map(doc => /*#__PURE__*/_jsxDEV(\"tr\", {\n              children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                children: doc.ProgramName || 'N/A'\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 211,\n                columnNumber: 47\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                children: doc.OrgSName || doc.OrgFName || 'N/A'\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 212,\n                columnNumber: 47\n              }, this), \" \", /*#__PURE__*/_jsxDEV(\"td\", {\n                children: doc.regnumber || 'N/A'\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 213,\n                columnNumber: 47\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                children: formatDate(doc.DateIssue)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 214,\n                columnNumber: 47\n              }, this), \" \", /*#__PURE__*/_jsxDEV(\"td\", {\n                children: /*#__PURE__*/_jsxDEV(\"button\", {\n                  className: \"details-button\",\n                  onClick: () => openModal(doc) // Pass the whole document object\n                  ,\n                  children: \"\\u0414\\u043E\\u043F\\u043E\\u043B\\u043D\\u0438\\u0442\\u0435\\u043B\\u044C\\u043D\\u043E\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 217,\n                  columnNumber: 51\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 215,\n                columnNumber: 47\n              }, this)]\n            }, doc.ID_Document, true, {\n              fileName: _jsxFileName,\n              lineNumber: 209,\n              columnNumber: 43\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 207,\n            columnNumber: 35\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 196,\n          columnNumber: 31\n        }, this) :\n        /*#__PURE__*/\n        // Message when no documents are available for the table view\n        _jsxDEV(\"div\", {\n          className: \"no-data-message full-width-message\",\n          children: user.role === 1 ? selectedWorker === null ? \"Пожалуйста, выберите работника для просмотра списка документов.\" : `Нет документов для отображения у выбранного работника (${getWorkerName()}).` : \"У вас пока нет загруженных документов.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 230,\n          columnNumber: 31\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 193,\n        columnNumber: 21\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 189,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(Modal, {\n      isOpen: isModalOpen,\n      onRequestClose: closeModal,\n      contentLabel: \"\\u0414\\u0435\\u0442\\u0430\\u043B\\u0438 \\u0434\\u043E\\u043A\\u0443\\u043C\\u0435\\u043D\\u0442\\u0430\" // Accessibility label\n      ,\n      className: \"modal-content\" // Class for styling the modal content\n      ,\n      overlayClassName: \"modal-overlay\" // Class for styling the background overlay\n      ,\n      ariaHideApp: true // Helps with screen readers\n      ,\n      children: selectedDocumentForModal ? /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          children: [\"\\u0414\\u0435\\u0442\\u0430\\u043B\\u0438 \\u0434\\u043E\\u043A\\u0443\\u043C\\u0435\\u043D\\u0442\\u0430 \\u2116 \", selectedDocumentForModal.regnumber || selectedDocumentForModal.ID_Document]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 253,\n          columnNumber: 37\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: closeModal,\n          className: \"modal-close-button\",\n          \"aria-label\": \"\\u0417\\u0430\\u043A\\u0440\\u044B\\u0442\\u044C\",\n          children: \"\\xD7\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 254,\n          columnNumber: 37\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"modal-details-grid\",\n          children: [/*#__PURE__*/_jsxDEV(\"p\", {\n            children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n              children: \"\\u0420\\u0430\\u0431\\u043E\\u0442\\u043D\\u0438\\u043A:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 259,\n              columnNumber: 46\n            }, this), \" \", selectedDocumentForModal.WorkerName || getWorkerName() || 'N/A']\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 259,\n            columnNumber: 43\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n              children: \"\\u041F\\u0440\\u043E\\u0433\\u0440\\u0430\\u043C\\u043C\\u0430 \\u043E\\u0431\\u0443\\u0447\\u0435\\u043D\\u0438\\u044F:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 260,\n              columnNumber: 46\n            }, this), \" \", selectedDocumentForModal.ProgramName || 'N/A']\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 260,\n            columnNumber: 43\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n              children: \"\\u041E\\u0440\\u0433\\u0430\\u043D\\u0438\\u0437\\u0430\\u0446\\u0438\\u044F (\\u043F\\u043E\\u043B\\u043D\\u043E\\u0435):\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 261,\n              columnNumber: 46\n            }, this), \" \", selectedDocumentForModal.OrgFName || 'N/A']\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 261,\n            columnNumber: 43\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n              children: \"\\u041E\\u0440\\u0433\\u0430\\u043D\\u0438\\u0437\\u0430\\u0446\\u0438\\u044F (\\u043A\\u0440\\u0430\\u0442\\u043A\\u043E\\u0435):\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 262,\n              columnNumber: 46\n            }, this), \" \", selectedDocumentForModal.OrgSName || 'N/A']\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 262,\n            columnNumber: 43\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n              children: \"\\u0420\\u0435\\u0433\\u0438\\u0441\\u0442\\u0440\\u0430\\u0446\\u0438\\u043E\\u043D\\u043D\\u044B\\u0439 \\u043D\\u043E\\u043C\\u0435\\u0440:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 263,\n              columnNumber: 46\n            }, this), \" \", selectedDocumentForModal.regnumber || 'N/A']\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 263,\n            columnNumber: 43\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n              children: \"\\u0414\\u0430\\u0442\\u0430 \\u0432\\u044B\\u0434\\u0430\\u0447\\u0438:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 264,\n              columnNumber: 46\n            }, this), \" \", formatDate(selectedDocumentForModal.DateIssue)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 264,\n            columnNumber: 43\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"kks-details\",\n            children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n              children: \"\\u041A\\u0440\\u0438\\u0442\\u0435\\u0440\\u0438\\u0438 \\u041A\\u041A\\u0421:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 269,\n              columnNumber: 46\n            }, this), Array.isArray(selectedDocumentForModal.KKS_Data) && selectedDocumentForModal.KKS_Data.length > 0 ? selectedDocumentForModal.KKS_Data.map(k => k.fullName || k.shortName) // Prefer full name, fallback to short\n            .filter(Boolean) // Remove any null/empty values\n            .join(', ') // Join with comma and space\n            : 'Нет данных', \" \"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 268,\n            columnNumber: 42\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 257,\n          columnNumber: 37\n        }, this)]\n      }, void 0, true) :\n      /*#__PURE__*/\n      // Fallback message if modal opens before data is ready (shouldn't usually happen)\n      _jsxDEV(\"p\", {\n        children: \"\\u0417\\u0430\\u0433\\u0440\\u0443\\u0437\\u043A\\u0430 \\u0434\\u0435\\u0442\\u0430\\u043B\\u0435\\u0439...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 282,\n        columnNumber: 33\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 241,\n      columnNumber: 25\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 180,\n    columnNumber: 9\n  }, this);\n}\n_s(Documents, \"rRl2/xmtm81OkfacnsuC81olUyo=\", false, function () {\n  return [useNavigate];\n});\n_c = Documents;\nexport default Documents;\nvar _c;\n$RefreshReg$(_c, \"Documents\");","map":{"version":3,"names":["React","useState","useEffect","useMemo","useCallback","axios","useNavigate","jsxDEV","_jsxDEV","Fragment","_Fragment","apiUrl","process","env","REACT_APP_API_URL","formatDate","dateStr","date","Date","isNaN","getTime","toLocaleDateString","e","console","error","Documents","_s","documents","setDocuments","loading","setLoading","setError","user","setUser","isModalOpen","setIsModalOpen","selectedDocumentForModal","setSelectedDocumentForModal","sortConfig","setSortConfig","key","direction","navigate","sortDocuments","docs","config","Array","isArray","sort","a","b","includes","dateA","dateB","valA","valB","String","toLowerCase","requestSort","renderSortableHeader","label","onClick","className","style","cursor","children","fileName","_jsxFileName","lineNumber","columnNumber","storedUser","localStorage","getItem","JSON","parse","removeItem","fetchDocuments","workerId","undefined","response","get","params","userId","role","data","Error","err","_err$response","_err$response$data","sortedDocuments","handleLogout","handleBack","length","selectedWorker","filteredDocuments","map","doc","ProgramName","OrgSName","OrgFName","regnumber","DateIssue","openModal","ID_Document","getWorkerName","Modal","isOpen","onRequestClose","closeModal","contentLabel","overlayClassName","ariaHideApp","WorkerName","KKS_Data","k","fullName","shortName","filter","Boolean","join","_c","$RefreshReg$"],"sources":["D:/Amina/VScode/FQW_new/src/components/Documents.js"],"sourcesContent":["import React, { useState, useEffect, useMemo, useCallback } from 'react';\nimport axios from 'axios';\nimport { useNavigate } from 'react-router-dom';\nimport './Documents.css';\n\nconst apiUrl = process.env.REACT_APP_API_URL;\n\n// Вспомогательная функция для форматирования даты\nconst formatDate = (dateStr) => {\n    if (!dateStr) return 'N/A';\n    try {\n        const date = new Date(dateStr);\n        return isNaN(date.getTime()) ? 'Неверная дата' : date.toLocaleDateString('ru-RU');\n    } catch (e) {\n        console.error(\"Error formatting date:\", dateStr, e);\n        return 'Ошибка даты';\n    }\n};\n\nfunction Documents() {\n    const [documents, setDocuments] = useState([]);\n    const [loading, setLoading] = useState(true);\n    const [error, setError] = useState('');\n    const [user, setUser] = useState(null);\n    const [isModalOpen, setIsModalOpen] = useState(false);\n    const [selectedDocumentForModal, setSelectedDocumentForModal] = useState(null);\n    const [sortConfig, setSortConfig] = useState({ key: 'DateIssue', direction: 'descending' });\n    const navigate = useNavigate();\n\n    // Функция сортировки документов\n    const sortDocuments = (docs, config) => {\n        if (!config.key || !Array.isArray(docs)) return docs || [];\n        \n        return [...docs].sort((a, b) => {\n            // Сортировка по дате\n            if (['DateIssue', 'DataStart', 'DataEnd'].includes(config.key)) {\n                const dateA = a[config.key] ? new Date(a[config.key]).getTime() : 0;\n                const dateB = b[config.key] ? new Date(b[config.key]).getTime() : 0;\n                if (dateA < dateB) return config.direction === 'ascending' ? -1 : 1;\n                if (dateA > dateB) return config.direction === 'ascending' ? 1 : -1;\n                return 0;\n            }\n            \n            // Сортировка по числовым полям\n            if (['ID_Document', 'ID_Worker', 'ID_ProgDPO'].includes(config.key)) {\n                const valA = a[config.key] || 0;\n                const valB = b[config.key] || 0;\n                return config.direction === 'ascending' ? valA - valB : valB - valA;\n            }\n            \n            // Сортировка по текстовым полям\n            const valA = String(a[config.key] || '').toLowerCase();\n            const valB = String(b[config.key] || '').toLowerCase();\n            if (valA < valB) return config.direction === 'ascending' ? -1 : 1;\n            if (valA > valB) return config.direction === 'ascending' ? 1 : -1;\n            return 0;\n        });\n    };\n\n    // Функция для изменения сортировки\n    const requestSort = (key) => {\n        let direction = 'ascending';\n        if (sortConfig.key === key && sortConfig.direction === 'ascending') {\n            direction = 'descending';\n        }\n        setSortConfig({ key, direction });\n    };\n\n    // Компонент для заголовков с сортировкой\n    const renderSortableHeader = (label, key) => (\n        <th \n            onClick={() => requestSort(key)} \n            className=\"sortable-header\"\n            style={{ cursor: 'pointer' }}\n        >\n            {label} \n            {sortConfig.key === key ? (\n                sortConfig.direction === 'ascending' ? ' ▲' : ' ▼'\n            ) : ' ↕'}\n        </th>\n    );\n\n    // Загрузка пользователя\n    useEffect(() => {\n        const storedUser = localStorage.getItem('user');\n        if (storedUser) {\n            try {\n                setUser(JSON.parse(storedUser));\n            } catch (e) {\n                console.error(\"Ошибка парсинга пользователя:\", e);\n                localStorage.removeItem('user');\n                setError(\"Ошибка данных пользователя. Пожалуйста, войдите снова.\");\n                setLoading(false);\n            }\n        } else {\n            setError(\"Пользователь не аутентифицирован.\");\n            setLoading(false);\n        }\n    }, []);\n\n    // Загрузка документов\n    const fetchDocuments = useCallback(async () => {\n        if (!user || user.workerId === undefined) {\n            if (user !== null) {\n                setError('Не удалось получить ID пользователя.');\n            }\n            setLoading(false);\n            return;\n        }\n\n        setLoading(true);\n        setError('');\n\n        try {\n            const response = await axios.get(`${apiUrl}/api/documents`, {\n                params: {\n                    userId: user.workerId,\n                    role: user.role\n                }\n            });\n\n            if (!Array.isArray(response.data)) {\n                throw new Error(\"Неверный формат данных документов.\");\n            }\n\n            setDocuments(response.data);\n\n        } catch (err) {\n            console.error('Ошибка при загрузке документов:', err);\n            setError(err.response?.data?.error || 'Ошибка при загрузке документов');\n            setDocuments([]);\n        } finally {\n            setLoading(false);\n        }\n    }, [user, apiUrl]);\n\n    useEffect(() => {\n        if (user) {\n            fetchDocuments();\n        }\n    }, [user, fetchDocuments]);\n\n    // Отсортированные документы\n    const sortedDocuments = useMemo(() => {\n        return sortDocuments(documents, sortConfig);\n    }, [documents, sortConfig]);\n\n    // Обработчики\n    const handleLogout = () => {\n        localStorage.removeItem('user');\n        navigate('/login');\n    };\n\n    const handleBack = () => {\n        if (user) {\n            navigate(user.role === 1 ? '/admin' : '/user');\n        } else {\n            navigate('/login');\n        }\n    };\n\n    // Состояния загрузки и ошибок\n    if (user === null && loading) return <div className=\"loading\">Загрузка данных пользователя...</div>;\n    if (error) return (\n        <div className=\"documents-container\">\n            <div className=\"documents-header\">\n                <h1>Ошибка</h1>\n                <div className=\"header-buttons\">\n                    <button onClick={handleBack} className=\"back-button\">Назад</button>\n                    <button onClick={handleLogout} className=\"logout-button\">Выйти</button>\n                </div>\n            </div>\n            <div className=\"error\">{error}</div>\n        </div>\n    );\n    if (loading) return <div className=\"loading\">Загрузка документов...</div>;\n    if (!user) return <div className=\"error\">Не удалось загрузить данные пользователя. <button onClick={() => navigate('/login')}>Войти</button></div>;\n\n    return (\n        <div className=\"documents-container\">\n            <div className=\"documents-header\">\n                <h1>{user.role === 1 ? 'Все документы' : 'Мои документы'}</h1>\n                <div className=\"header-buttons\">\n                    <button onClick={handleBack} className=\"back-button\">Назад</button>\n                    <button onClick={handleLogout} className=\"logout-button\">Выйти</button>\n                </div>\n            </div>\n\n            <div className=\"documents-list\">\n                {sortedDocuments.length === 0 ? (\n                    <p className=\"no-documents\">Документы не найдены</p>\n                ) : (\n                    <div className=\"documents-list\">\n                         {/* Conditional Rendering for the table */}\n                          {(user.role !== 1 || selectedWorker !== null) && filteredDocuments.length > 0 ? (\n                              <table className=\"documents-table\">\n                                  <thead>\n                                    <tr>\n                                        {/* Show Worker column only for Admin */}\n                                        {renderSortableHeader('Программа обучения', 'ProgramName')}\n                                        {renderSortableHeader('Организация', 'OrgSName')}\n                                        {renderSortableHeader('Рег. номер', 'regnumber')}\n                                        {renderSortableHeader('Дата выдачи', 'DateIssue')}\n                                        <th>Действия</th>\n                                    </tr>\n                                  </thead>\n                                  <tbody>\n                                      {filteredDocuments.map((doc) => (\n                                          <tr key={doc.ID_Document}>\n                                              {/* Document Details cells */}\n                                              <td>{doc.ProgramName || 'N/A'}</td>\n                                              <td>{doc.OrgSName || doc.OrgFName || 'N/A'}</td> {/* Display Short name, fallback to Full */}\n                                              <td>{doc.regnumber || 'N/A'}</td>\n                                              <td>{formatDate(doc.DateIssue)}</td> {/* Use formatted date */}\n                                              <td>\n                                                  {/* Button to open the modal */}\n                                                  <button\n                                                      className=\"details-button\"\n                                                      onClick={() => openModal(doc)} // Pass the whole document object\n                                                  >\n                                                      Дополнительно\n                                                  </button>\n                                              </td>\n                                          </tr>\n                                      ))}\n                                  </tbody>\n                              </table>\n                          ) : (\n                              // Message when no documents are available for the table view\n                              <div className=\"no-data-message full-width-message\">\n                                  {user.role === 1 ?\n                                      (selectedWorker === null ? \"Пожалуйста, выберите работника для просмотра списка документов.\" : `Нет документов для отображения у выбранного работника (${getWorkerName()}).`) :\n                                      \"У вас пока нет загруженных документов.\"\n                                  }\n                              </div>\n                          )}\n                     </div>\n                )}\n            </div>\n            {/* Modal Definition */}\n                        <Modal\n                            isOpen={isModalOpen}\n                            onRequestClose={closeModal}\n                            contentLabel=\"Детали документа\" // Accessibility label\n                            className=\"modal-content\" // Class for styling the modal content\n                            overlayClassName=\"modal-overlay\" // Class for styling the background overlay\n                            ariaHideApp={true} // Helps with screen readers\n                        >\n                            {/* Content inside the modal */}\n                            {selectedDocumentForModal ? (\n                                <>\n                                    {/* Modal Header */}\n                                    <h2>Детали документа № {selectedDocumentForModal.regnumber || selectedDocumentForModal.ID_Document}</h2>\n                                    <button onClick={closeModal} className=\"modal-close-button\" aria-label=\"Закрыть\">&times;</button>\n            \n                                    {/* Modal Body with Details */}\n                                    <div className=\"modal-details-grid\">\n                                         {/* Display various document details */}\n                                          <p><strong>Работник:</strong> {selectedDocumentForModal.WorkerName || getWorkerName() || 'N/A'}</p>\n                                          <p><strong>Программа обучения:</strong> {selectedDocumentForModal.ProgramName || 'N/A'}</p>\n                                          <p><strong>Организация (полное):</strong> {selectedDocumentForModal.OrgFName || 'N/A'}</p>\n                                          <p><strong>Организация (краткое):</strong> {selectedDocumentForModal.OrgSName || 'N/A'}</p>\n                                          <p><strong>Регистрационный номер:</strong> {selectedDocumentForModal.regnumber || 'N/A'}</p>\n                                          <p><strong>Дата выдачи:</strong> {formatDate(selectedDocumentForModal.DateIssue)}</p>\n                                          {/* Add any other relevant fields from your 'doc' object */}\n            \n                                          {/* Display KKS Criteria */}\n                                         <p className=\"kks-details\">\n                                             <strong>Критерии ККС:</strong>\n                                             {/* Check if KKS_Data is an array and has items */}\n                                              {Array.isArray(selectedDocumentForModal.KKS_Data) && selectedDocumentForModal.KKS_Data.length > 0\n                                                  ? selectedDocumentForModal.KKS_Data\n                                                        .map(k => k.fullName || k.shortName) // Prefer full name, fallback to short\n                                                        .filter(Boolean) // Remove any null/empty values\n                                                        .join(', ') // Join with comma and space\n                                                  : 'Нет данных'} {/* Message if no KKS data or not an array */}\n                                         </p>\n                                    </div>\n                                </>\n                            ) : (\n                                 // Fallback message if modal opens before data is ready (shouldn't usually happen)\n                                <p>Загрузка деталей...</p>\n                            )}\n                        </Modal>\n        </div>\n    );\n}\n\nexport default Documents;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}