{"ast":null,"code":"var _jsxFileName = \"D:\\\\Amina\\\\VScode\\\\FQW_new\\\\src\\\\components\\\\Documents.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useCallback } from 'react';\nimport axios from 'axios';\nimport { useNavigate } from 'react-router-dom';\nimport Modal from 'react-modal'; // Import Modal\nimport './Documents.css';\n\n// --- Set App Element for Accessibility ---\n// Make sure to set this to your app's root element selector (e.g., '#root', '#app')\n// You can also call this inside a useEffect hook\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nModal.setAppElement('#root'); // Adjust '#root' if your root element has a different ID\n\nfunction Documents() {\n  _s();\n  const [documents, setDocuments] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState('');\n  const [isModalOpen, setIsModalOpen] = useState(false); // State for modal visibility\n  const [selectedDocumentForModal, setSelectedDocumentForModal] = useState(null); // State for selected document data\n  const navigate = useNavigate();\n  const user = JSON.parse(localStorage.getItem('user'));\n  const fetchDocuments = useCallback(async () => {\n    // Reset state before fetching\n    setLoading(true);\n    setError('');\n    setDocuments([]); // Clear previous documents\n\n    if (!user || !user.id || typeof user.role === 'undefined') {\n      console.error('User data is missing or invalid in localStorage');\n      setError('Ошибка: Не удалось получить данные пользователя. Пожалуйста, войдите снова.');\n      setLoading(false);\n      localStorage.removeItem('user'); // Clear invalid user data\n      navigate('/login'); // Redirect to login\n      return;\n    }\n    try {\n      console.log('Отправка запроса документов:', {\n        userId: user.id,\n        role: user.role\n      });\n      const response = await axios.get(`http://localhost:5000/api/documents`, {\n        params: {\n          userId: user.id,\n          role: user.role\n        }\n      });\n      console.log('Получены документы:', response.data);\n\n      // Ensure response.data is an array\n      const receivedDocuments = Array.isArray(response.data) ? response.data : [];\n      receivedDocuments.forEach((doc, index) => {\n        console.log(`Документ ${index + 1}:`, {\n          regnumber: doc.regnumber,\n          formseries: doc.formseries,\n          formnumber: doc.formnumber,\n          // Log potentially new fields if needed\n          OrgSName: doc.OrgSName,\n          OrgFName: doc.OrgFName,\n          KKS_Data: doc.KKS_Data,\n          WorkerName: doc.WorkerName,\n          ProgramName: doc.ProgramName,\n          DateIssue: doc.DateIssue,\n          ID_Document: doc.ID_Document // Ensure ID is present for key\n        });\n      });\n      setDocuments(receivedDocuments);\n      setLoading(false);\n    } catch (err) {\n      var _err$response, _err$response$data;\n      console.error('Ошибка при загрузке документов:', err);\n      const errorMessage = ((_err$response = err.response) === null || _err$response === void 0 ? void 0 : (_err$response$data = _err$response.data) === null || _err$response$data === void 0 ? void 0 : _err$response$data.error) || err.message || 'Неизвестная ошибка при загрузке документов';\n      setError(`Ошибка при загрузке документов: ${errorMessage}`);\n      setLoading(false);\n    }\n  }, [user === null || user === void 0 ? void 0 : user.id, user === null || user === void 0 ? void 0 : user.role, navigate]); // Add navigate as dependency if used inside useCallback indirectly\n\n  useEffect(() => {\n    // Only fetch if user data is available\n    if (user && user.id && typeof user.role !== 'undefined') {\n      fetchDocuments();\n    } else {\n      // Handle case where user is not properly loaded (e.g., redirect or show error)\n      setError('Данные пользователя не найдены. Перенаправление на страницу входа...');\n      setLoading(false);\n      // Optional: add a small delay before navigating\n      const timer = setTimeout(() => {\n        navigate('/login');\n      }, 2000);\n      return () => clearTimeout(timer); // Cleanup timer on component unmount\n    }\n  }, [fetchDocuments, user, navigate]); // Add user and navigate dependencies\n\n  // --- Modal Handlers ---\n  const openModal = doc => {\n    console.log(\"Opening modal for doc:\", doc); // Debug log\n    setSelectedDocumentForModal(doc);\n    setIsModalOpen(true);\n  };\n  const closeModal = () => {\n    setIsModalOpen(false);\n    setSelectedDocumentForModal(null);\n  };\n\n  // --- Helper Function for Date Formatting ---\n  const formatDate = dateString => {\n    if (!dateString) return 'N/A';\n    try {\n      const date = new Date(dateString);\n      // Basic validation\n      if (isNaN(date.getTime())) {\n        return 'Неверная дата';\n      }\n      return date.toLocaleDateString('ru-RU'); // Adjust locale as needed (e.g., 'en-CA', 'default')\n    } catch (e) {\n      console.error(\"Error formatting date:\", dateString, e);\n      return 'Ошибка даты';\n    }\n  };\n\n  // --- Navigation Handlers ---\n  const handleLogout = () => {\n    localStorage.removeItem('user');\n    navigate('/login');\n  };\n  const handleBack = () => {\n    // Navigate back based on role, ensuring user exists\n    if (user) {\n      navigate(user.role === 1 ? '/admin' : '/user');\n    } else {\n      navigate('/login'); // Fallback if user somehow null\n    }\n  };\n\n  // --- Render Logic ---\n  if (loading) return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"loading\",\n    children: \"\\u0417\\u0430\\u0433\\u0440\\u0443\\u0437\\u043A\\u0430...\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 135,\n    columnNumber: 23\n  }, this);\n  // Display error prominently if it occurs\n  if (error) return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"error-container\",\n    children: [/*#__PURE__*/_jsxDEV(\"p\", {\n      className: \"error\",\n      children: error\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 138,\n      columnNumber: 25\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: handleBack,\n      className: \"back-button\",\n      children: \"\\u041D\\u0430\\u0437\\u0430\\u0434\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 139,\n      columnNumber: 25\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: handleLogout,\n      className: \"logout-button\",\n      children: \"\\u0412\\u044B\\u0439\\u0442\\u0438\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 140,\n      columnNumber: 25\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 137,\n    columnNumber: 21\n  }, this);\n  // Ensure user data is available before rendering main content\n  if (!user) return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"error\",\n    children: [\"\\u041E\\u0448\\u0438\\u0431\\u043A\\u0430: \\u041F\\u043E\\u043B\\u044C\\u0437\\u043E\\u0432\\u0430\\u0442\\u0435\\u043B\\u044C \\u043D\\u0435 \\u0430\\u0432\\u0442\\u043E\\u0440\\u0438\\u0437\\u043E\\u0432\\u0430\\u043D. \", /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: () => navigate('/login'),\n      children: \"\\u0412\\u043E\\u0439\\u0442\\u0438\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 143,\n      columnNumber: 81\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 143,\n    columnNumber: 21\n  }, this);\n\n  // Determine the correct worker name for the modal (especially if admin role was viewing specific worker)\n  // Since this component doesn't have worker selection, we primarily rely on doc.WorkerName\n  // If user is not admin, their own name could be retrieved from 'user' object if available, otherwise 'N/A'\n  const getModalWorkerName = doc => {\n    if (user.role === 1) {\n      return (doc === null || doc === void 0 ? void 0 : doc.WorkerName) || 'N/A'; // For admin, use the name from the document data\n    } else {\n      // For regular users, you might want to display their name from the 'user' object\n      return (user === null || user === void 0 ? void 0 : user.name) || (user === null || user === void 0 ? void 0 : user.username) || 'N/A'; // Adjust based on your user object structure\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"documents-container\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"documents-header\",\n      children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n        children: user.role === 1 ? 'Все документы' : 'Мои документы'\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 162,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"header-buttons\",\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: handleBack,\n          className: \"back-button\",\n          children: \"\\u041D\\u0430\\u0437\\u0430\\u0434\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 164,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: handleLogout,\n          className: \"logout-button\",\n          children: \"\\u0412\\u044B\\u0439\\u0442\\u0438\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 165,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 163,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 161,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"documents-list\",\n      children: documents.length > 0 ? /*#__PURE__*/_jsxDEV(\"table\", {\n        className: \"documents-table\",\n        children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n          children: /*#__PURE__*/_jsxDEV(\"tr\", {\n            children: [user.role === 1 && /*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"\\u0420\\u0430\\u0431\\u043E\\u0442\\u043D\\u0438\\u043A\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 177,\n              columnNumber: 37\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"\\u041F\\u0440\\u043E\\u0433\\u0440\\u0430\\u043C\\u043C\\u0430 \\u043E\\u0431\\u0443\\u0447\\u0435\\u043D\\u0438\\u044F\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 178,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"\\u041E\\u0440\\u0433\\u0430\\u043D\\u0438\\u0437\\u0430\\u0446\\u0438\\u044F (\\u041A\\u0440\\u0430\\u0442\\u043A\\u043E)\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 179,\n              columnNumber: 17\n            }, this), \" \", /*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"\\u0420\\u0435\\u0433. \\u043D\\u043E\\u043C\\u0435\\u0440\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 180,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"\\u0414\\u0430\\u0442\\u0430 \\u0432\\u044B\\u0434\\u0430\\u0447\\u0438\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 181,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"\\u0414\\u0435\\u0439\\u0441\\u0442\\u0432\\u0438\\u044F\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 182,\n              columnNumber: 17\n            }, this), \" \"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 175,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 174,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n          children: documents.map(doc => /*#__PURE__*/_jsxDEV(\"tr\", {\n            children: [\" \", user.role === 1 && /*#__PURE__*/_jsxDEV(\"td\", {\n              children: doc.WorkerName || 'N/A'\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 189,\n              columnNumber: 39\n            }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n              children: doc.ProgramName || 'N/A'\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 191,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n              children: doc.OrgSName || doc.OrgFName || 'N/A'\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 193,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n              children: doc.regnumber || 'N/A'\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 194,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n              children: formatDate(doc.DateIssue)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 195,\n              columnNumber: 19\n            }, this), \" \", /*#__PURE__*/_jsxDEV(\"td\", {\n              children: /*#__PURE__*/_jsxDEV(\"button\", {\n                className: \"details-button\",\n                onClick: () => openModal(doc) // Pass the whole document object\n                ,\n                children: \"\\u041F\\u043E\\u0434\\u0440\\u043E\\u0431\\u043D\\u043E\\u0441\\u0442\\u0438\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 198,\n                columnNumber: 21\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 196,\n              columnNumber: 19\n            }, this)]\n          }, doc.ID_Document || doc.regnumber, true, {\n            fileName: _jsxFileName,\n            lineNumber: 187,\n            columnNumber: 17\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 185,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 173,\n        columnNumber: 11\n      }, this) :\n      /*#__PURE__*/\n      // Message when no documents are available for the table view\n      _jsxDEV(\"div\", {\n        className: \"no-data-message full-width-message\",\n        children: /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"no-documents\",\n          children: user.role === 1 ? \"Документы не найдены для отображения.\" : \"У вас пока нет загруженных документов.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 212,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 211,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 170,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Modal, {\n      isOpen: isModalOpen,\n      onRequestClose: closeModal,\n      contentLabel: \"\\u0414\\u0435\\u0442\\u0430\\u043B\\u0438 \\u0434\\u043E\\u043A\\u0443\\u043C\\u0435\\u043D\\u0442\\u0430\" // Accessibility label\n      ,\n      className: \"modal-content\" // Class for styling the modal content\n      ,\n      overlayClassName: \"modal-overlay\" // Class for styling the background overlay\n      ,\n      ariaHideApp: false // Set to false if causing issues, but true with setAppElement is better\n      ,\n      children: selectedDocumentForModal ? /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"modal-header\",\n          children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n            children: [\"\\u0414\\u0435\\u0442\\u0430\\u043B\\u0438 \\u0434\\u043E\\u043A\\u0443\\u043C\\u0435\\u043D\\u0442\\u0430 \\u2116 \", selectedDocumentForModal.regnumber || selectedDocumentForModal.ID_Document || 'N/A']\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 236,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: closeModal,\n            className: \"modal-close-button\",\n            \"aria-label\": \"\\u0417\\u0430\\u043A\\u0440\\u044B\\u0442\\u044C\",\n            children: \"\\xD7\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 237,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 235,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"modal-body\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"modal-details-grid\",\n            children: [/*#__PURE__*/_jsxDEV(\"p\", {\n              children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                children: \"\\u0420\\u0430\\u0431\\u043E\\u0442\\u043D\\u0438\\u043A:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 245,\n                columnNumber: 22\n              }, this), \" \", getModalWorkerName(selectedDocumentForModal)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 245,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                children: \"\\u041F\\u0440\\u043E\\u0433\\u0440\\u0430\\u043C\\u043C\\u0430 \\u043E\\u0431\\u0443\\u0447\\u0435\\u043D\\u0438\\u044F:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 246,\n                columnNumber: 22\n              }, this), \" \", selectedDocumentForModal.ProgramName || 'N/A']\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 246,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                children: \"\\u041E\\u0440\\u0433\\u0430\\u043D\\u0438\\u0437\\u0430\\u0446\\u0438\\u044F (\\u043F\\u043E\\u043B\\u043D\\u043E\\u0435):\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 247,\n                columnNumber: 22\n              }, this), \" \", selectedDocumentForModal.OrgFName || 'N/A']\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 247,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                children: \"\\u041E\\u0440\\u0433\\u0430\\u043D\\u0438\\u0437\\u0430\\u0446\\u0438\\u044F (\\u043A\\u0440\\u0430\\u0442\\u043A\\u043E\\u0435):\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 248,\n                columnNumber: 22\n              }, this), \" \", selectedDocumentForModal.OrgSName || 'N/A']\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 248,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                children: \"\\u0420\\u0435\\u0433\\u0438\\u0441\\u0442\\u0440\\u0430\\u0446\\u0438\\u043E\\u043D\\u043D\\u044B\\u0439 \\u043D\\u043E\\u043C\\u0435\\u0440:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 249,\n                columnNumber: 22\n              }, this), \" \", selectedDocumentForModal.regnumber || 'N/A']\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 249,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                children: \"\\u0421\\u0435\\u0440\\u0438\\u044F \\u0444\\u043E\\u0440\\u043C\\u044B:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 250,\n                columnNumber: 22\n              }, this), \" \", selectedDocumentForModal.formseries || 'N/A']\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 250,\n              columnNumber: 19\n            }, this), \" \", /*#__PURE__*/_jsxDEV(\"p\", {\n              children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                children: \"\\u041D\\u043E\\u043C\\u0435\\u0440 \\u0444\\u043E\\u0440\\u043C\\u044B:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 251,\n                columnNumber: 22\n              }, this), \" \", selectedDocumentForModal.formnumber || 'N/A']\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 251,\n              columnNumber: 19\n            }, this), \" \", /*#__PURE__*/_jsxDEV(\"p\", {\n              children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                children: \"\\u0414\\u0430\\u0442\\u0430 \\u0432\\u044B\\u0434\\u0430\\u0447\\u0438:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 252,\n                columnNumber: 22\n              }, this), \" \", formatDate(selectedDocumentForModal.DateIssue)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 252,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                children: \"\\u0414\\u0430\\u0442\\u0430 \\u043D\\u0430\\u0447\\u0430\\u043B\\u0430:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 253,\n                columnNumber: 22\n              }, this), \" \", formatDate(selectedDocumentForModal.DataStart)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 253,\n              columnNumber: 19\n            }, this), \" \", /*#__PURE__*/_jsxDEV(\"p\", {\n              children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                children: \"\\u0414\\u0430\\u0442\\u0430 \\u043E\\u043A\\u043E\\u043D\\u0447\\u0430\\u043D\\u0438\\u044F:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 254,\n                columnNumber: 22\n              }, this), \" \", formatDate(selectedDocumentForModal.DataEnd)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 254,\n              columnNumber: 19\n            }, this), \" \", /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"kks-details full-span-grid\",\n              children: [\" \", /*#__PURE__*/_jsxDEV(\"strong\", {\n                children: \"\\u041A\\u0440\\u0438\\u0442\\u0435\\u0440\\u0438\\u0438 \\u041A\\u041A\\u0421:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 258,\n                columnNumber: 23\n              }, this), Array.isArray(selectedDocumentForModal.KKS_Data) && selectedDocumentForModal.KKS_Data.length > 0 ? selectedDocumentForModal.KKS_Data.map(k => (k === null || k === void 0 ? void 0 : k.fullName) || (k === null || k === void 0 ? void 0 : k.shortName) || k) // Try getting name, fallback to object/string itself if names aren't present\n              .filter(Boolean) // Remove any null/empty values\n              .join(', ') // Join with comma and space\n              : ' Нет данных', \" \"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 257,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 242,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 241,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true) :\n      /*#__PURE__*/\n      // Fallback message if modal opens before data is ready (shouldn't usually happen with this logic)\n      _jsxDEV(\"p\", {\n        children: \"\\u0417\\u0430\\u0433\\u0440\\u0443\\u0437\\u043A\\u0430 \\u0434\\u0435\\u0442\\u0430\\u043B\\u0435\\u0439...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 276,\n        columnNumber: 13\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 223,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 160,\n    columnNumber: 5\n  }, this);\n}\n_s(Documents, \"l8zGM/tWuBK9hhiVgG7uC753DRE=\", false, function () {\n  return [useNavigate];\n});\n_c = Documents;\nexport default Documents;\nvar _c;\n$RefreshReg$(_c, \"Documents\");","map":{"version":3,"names":["React","useState","useEffect","useCallback","axios","useNavigate","Modal","jsxDEV","_jsxDEV","Fragment","_Fragment","setAppElement","Documents","_s","documents","setDocuments","loading","setLoading","error","setError","isModalOpen","setIsModalOpen","selectedDocumentForModal","setSelectedDocumentForModal","navigate","user","JSON","parse","localStorage","getItem","fetchDocuments","id","role","console","removeItem","log","userId","response","get","params","data","receivedDocuments","Array","isArray","forEach","doc","index","regnumber","formseries","formnumber","OrgSName","OrgFName","KKS_Data","WorkerName","ProgramName","DateIssue","ID_Document","err","_err$response","_err$response$data","errorMessage","message","timer","setTimeout","clearTimeout","openModal","closeModal","formatDate","dateString","date","Date","isNaN","getTime","toLocaleDateString","e","handleLogout","handleBack","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onClick","getModalWorkerName","name","username","length","map","isOpen","onRequestClose","contentLabel","overlayClassName","ariaHideApp","DataStart","DataEnd","k","fullName","shortName","filter","Boolean","join","_c","$RefreshReg$"],"sources":["D:/Amina/VScode/FQW_new/src/components/Documents.js"],"sourcesContent":["import React, { useState, useEffect, useCallback } from 'react';\nimport axios from 'axios';\nimport { useNavigate } from 'react-router-dom';\nimport Modal from 'react-modal'; // Import Modal\nimport './Documents.css';\n\n// --- Set App Element for Accessibility ---\n// Make sure to set this to your app's root element selector (e.g., '#root', '#app')\n// You can also call this inside a useEffect hook\nModal.setAppElement('#root'); // Adjust '#root' if your root element has a different ID\n\nfunction Documents() {\n  const [documents, setDocuments] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState('');\n  const [isModalOpen, setIsModalOpen] = useState(false); // State for modal visibility\n  const [selectedDocumentForModal, setSelectedDocumentForModal] = useState(null); // State for selected document data\n  const navigate = useNavigate();\n  const user = JSON.parse(localStorage.getItem('user'));\n\n  const fetchDocuments = useCallback(async () => {\n    // Reset state before fetching\n    setLoading(true);\n    setError('');\n    setDocuments([]); // Clear previous documents\n\n    if (!user || !user.id || typeof user.role === 'undefined') {\n      console.error('User data is missing or invalid in localStorage');\n      setError('Ошибка: Не удалось получить данные пользователя. Пожалуйста, войдите снова.');\n      setLoading(false);\n      localStorage.removeItem('user'); // Clear invalid user data\n      navigate('/login'); // Redirect to login\n      return;\n    }\n\n    try {\n      console.log('Отправка запроса документов:', { userId: user.id, role: user.role });\n      const response = await axios.get(`http://localhost:5000/api/documents`, {\n        params: {\n          userId: user.id,\n          role: user.role\n        }\n      });\n      console.log('Получены документы:', response.data);\n\n      // Ensure response.data is an array\n      const receivedDocuments = Array.isArray(response.data) ? response.data : [];\n\n      receivedDocuments.forEach((doc, index) => {\n          console.log(`Документ ${index + 1}:`, {\n            regnumber: doc.regnumber,\n            formseries: doc.formseries,\n            formnumber: doc.formnumber,\n            // Log potentially new fields if needed\n            OrgSName: doc.OrgSName,\n            OrgFName: doc.OrgFName,\n            KKS_Data: doc.KKS_Data,\n            WorkerName: doc.WorkerName,\n            ProgramName: doc.ProgramName,\n            DateIssue: doc.DateIssue,\n            ID_Document: doc.ID_Document // Ensure ID is present for key\n          });\n      });\n\n      setDocuments(receivedDocuments);\n      setLoading(false);\n    } catch (err) {\n      console.error('Ошибка при загрузке документов:', err);\n      const errorMessage = err.response?.data?.error || err.message || 'Неизвестная ошибка при загрузке документов';\n      setError(`Ошибка при загрузке документов: ${errorMessage}`);\n      setLoading(false);\n    }\n  }, [user?.id, user?.role, navigate]); // Add navigate as dependency if used inside useCallback indirectly\n\n  useEffect(() => {\n    // Only fetch if user data is available\n    if (user && user.id && typeof user.role !== 'undefined') {\n        fetchDocuments();\n    } else {\n        // Handle case where user is not properly loaded (e.g., redirect or show error)\n        setError('Данные пользователя не найдены. Перенаправление на страницу входа...');\n        setLoading(false);\n        // Optional: add a small delay before navigating\n        const timer = setTimeout(() => {\n            navigate('/login');\n        }, 2000);\n        return () => clearTimeout(timer); // Cleanup timer on component unmount\n    }\n  }, [fetchDocuments, user, navigate]); // Add user and navigate dependencies\n\n  // --- Modal Handlers ---\n  const openModal = (doc) => {\n    console.log(\"Opening modal for doc:\", doc); // Debug log\n    setSelectedDocumentForModal(doc);\n    setIsModalOpen(true);\n  };\n\n  const closeModal = () => {\n    setIsModalOpen(false);\n    setSelectedDocumentForModal(null);\n  };\n\n  // --- Helper Function for Date Formatting ---\n  const formatDate = (dateString) => {\n    if (!dateString) return 'N/A';\n    try {\n      const date = new Date(dateString);\n      // Basic validation\n      if (isNaN(date.getTime())) {\n          return 'Неверная дата';\n      }\n      return date.toLocaleDateString('ru-RU'); // Adjust locale as needed (e.g., 'en-CA', 'default')\n    } catch (e) {\n      console.error(\"Error formatting date:\", dateString, e);\n      return 'Ошибка даты';\n    }\n  };\n\n  // --- Navigation Handlers ---\n  const handleLogout = () => {\n    localStorage.removeItem('user');\n    navigate('/login');\n  };\n\n  const handleBack = () => {\n    // Navigate back based on role, ensuring user exists\n    if (user) {\n      navigate(user.role === 1 ? '/admin' : '/user');\n    } else {\n      navigate('/login'); // Fallback if user somehow null\n    }\n  };\n\n  // --- Render Logic ---\n  if (loading) return <div className=\"loading\">Загрузка...</div>;\n  // Display error prominently if it occurs\n  if (error) return <div className=\"error-container\">\n                        <p className=\"error\">{error}</p>\n                        <button onClick={handleBack} className=\"back-button\">Назад</button>\n                        <button onClick={handleLogout} className=\"logout-button\">Выйти</button>\n                    </div>;\n  // Ensure user data is available before rendering main content\n  if (!user) return <div className=\"error\">Ошибка: Пользователь не авторизован. <button onClick={() => navigate('/login')}>Войти</button></div>;\n\n\n  // Determine the correct worker name for the modal (especially if admin role was viewing specific worker)\n  // Since this component doesn't have worker selection, we primarily rely on doc.WorkerName\n  // If user is not admin, their own name could be retrieved from 'user' object if available, otherwise 'N/A'\n  const getModalWorkerName = (doc) => {\n      if (user.role === 1) {\n          return doc?.WorkerName || 'N/A'; // For admin, use the name from the document data\n      } else {\n          // For regular users, you might want to display their name from the 'user' object\n          return user?.name || user?.username || 'N/A'; // Adjust based on your user object structure\n      }\n  };\n\n\n  return (\n    <div className=\"documents-container\">\n      <div className=\"documents-header\">\n        <h1>{user.role === 1 ? 'Все документы' : 'Мои документы'}</h1>\n        <div className=\"header-buttons\">\n          <button onClick={handleBack} className=\"back-button\">Назад</button>\n          <button onClick={handleLogout} className=\"logout-button\">Выйти</button>\n        </div>\n      </div>\n\n      {/* --- Documents List Section --- */}\n      <div className=\"documents-list\">\n        {/* Conditional Rendering for the table */}\n        {documents.length > 0 ? (\n          <table className=\"documents-table\">\n            <thead>\n              <tr>\n                {/* Show Worker column only for Admin */}\n                {user.role === 1 && <th>Работник</th>}\n                <th>Программа обучения</th>\n                <th>Организация (Кратко)</th> {/* New Column */}\n                <th>Рег. номер</th>\n                <th>Дата выдачи</th>\n                <th>Действия</th> {/* New Column for Button */}\n              </tr>\n            </thead>\n            <tbody>\n              {documents.map((doc) => (\n                <tr key={doc.ID_Document || doc.regnumber}> {/* Use a reliable unique key */}\n                  {/* Worker Name cell (Admin only) */}\n                  {user.role === 1 && <td>{doc.WorkerName || 'N/A'}</td>}\n                  {/* Document Details cells */}\n                  <td>{doc.ProgramName || 'N/A'}</td>\n                  {/* Display Short name, fallback to Full if needed, then N/A */}\n                  <td>{doc.OrgSName || doc.OrgFName || 'N/A'}</td>\n                  <td>{doc.regnumber || 'N/A'}</td>\n                  <td>{formatDate(doc.DateIssue)}</td> {/* Use formatted date */}\n                  <td>\n                    {/* Button to open the modal */}\n                    <button\n                      className=\"details-button\"\n                      onClick={() => openModal(doc)} // Pass the whole document object\n                    >\n                      Подробности\n                    </button>\n                  </td>\n                </tr>\n              ))}\n            </tbody>\n          </table>\n        ) : (\n          // Message when no documents are available for the table view\n          <div className=\"no-data-message full-width-message\">\n            <p className=\"no-documents\">\n              {user.role === 1\n                ? \"Документы не найдены для отображения.\"\n                : \"У вас пока нет загруженных документов.\"\n              }\n            </p>\n          </div>\n        )}\n      </div>\n\n      {/* --- Modal Definition --- */}\n      <Modal\n        isOpen={isModalOpen}\n        onRequestClose={closeModal}\n        contentLabel=\"Детали документа\" // Accessibility label\n        className=\"modal-content\" // Class for styling the modal content\n        overlayClassName=\"modal-overlay\" // Class for styling the background overlay\n        ariaHideApp={false} // Set to false if causing issues, but true with setAppElement is better\n      >\n        {/* Content inside the modal */}\n        {selectedDocumentForModal ? (\n          <>\n            {/* Modal Header */}\n            <div className=\"modal-header\">\n                <h2>Детали документа № {selectedDocumentForModal.regnumber || selectedDocumentForModal.ID_Document || 'N/A'}</h2>\n                <button onClick={closeModal} className=\"modal-close-button\" aria-label=\"Закрыть\">&times;</button>\n            </div>\n\n            {/* Modal Body with Details */}\n            <div className=\"modal-body\">\n              <div className=\"modal-details-grid\">\n                  {/* Display various document details */}\n                  {/* Use the helper function for potentially dynamic worker name display */}\n                  <p><strong>Работник:</strong> {getModalWorkerName(selectedDocumentForModal)}</p>\n                  <p><strong>Программа обучения:</strong> {selectedDocumentForModal.ProgramName || 'N/A'}</p>\n                  <p><strong>Организация (полное):</strong> {selectedDocumentForModal.OrgFName || 'N/A'}</p>\n                  <p><strong>Организация (краткое):</strong> {selectedDocumentForModal.OrgSName || 'N/A'}</p>\n                  <p><strong>Регистрационный номер:</strong> {selectedDocumentForModal.regnumber || 'N/A'}</p>\n                  <p><strong>Серия формы:</strong> {selectedDocumentForModal.formseries || 'N/A'}</p> {/* Added from original table */}\n                  <p><strong>Номер формы:</strong> {selectedDocumentForModal.formnumber || 'N/A'}</p> {/* Added from original table */}\n                  <p><strong>Дата выдачи:</strong> {formatDate(selectedDocumentForModal.DateIssue)}</p>\n                  <p><strong>Дата начала:</strong> {formatDate(selectedDocumentForModal.DataStart)}</p> {/* Added from original table */}\n                  <p><strong>Дата окончания:</strong> {formatDate(selectedDocumentForModal.DataEnd)}</p> {/* Added from original table */}\n\n                  {/* Display KKS Criteria */}\n                  <p className=\"kks-details full-span-grid\"> {/* Optional class to span grid columns if needed */}\n                      <strong>Критерии ККС:</strong>\n                      {/* Check if KKS_Data exists, is an array, and has items */}\n                      {Array.isArray(selectedDocumentForModal.KKS_Data) && selectedDocumentForModal.KKS_Data.length > 0\n                          ? selectedDocumentForModal.KKS_Data\n                                .map(k => k?.fullName || k?.shortName || k) // Try getting name, fallback to object/string itself if names aren't present\n                                .filter(Boolean) // Remove any null/empty values\n                                .join(', ') // Join with comma and space\n                          : ' Нет данных'} {/* Message if no KKS data or not an array */}\n                  </p>\n              </div>\n            </div>\n            {/* Optional Modal Footer */}\n            {/* <div className=\"modal-footer\">\n                <button onClick={closeModal} className=\"button\">Закрыть</button>\n            </div> */}\n          </>\n        ) : (\n            // Fallback message if modal opens before data is ready (shouldn't usually happen with this logic)\n            <p>Загрузка деталей...</p>\n        )}\n      </Modal>\n    </div>\n  );\n}\n\nexport default Documents;"],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,QAAQ,EAAEC,SAAS,EAAEC,WAAW,QAAQ,OAAO;AAC/D,OAAOC,KAAK,MAAM,OAAO;AACzB,SAASC,WAAW,QAAQ,kBAAkB;AAC9C,OAAOC,KAAK,MAAM,aAAa,CAAC,CAAC;AACjC,OAAO,iBAAiB;;AAExB;AACA;AACA;AAAA,SAAAC,MAAA,IAAAC,OAAA,EAAAC,QAAA,IAAAC,SAAA;AACAJ,KAAK,CAACK,aAAa,CAAC,OAAO,CAAC,CAAC,CAAC;;AAE9B,SAASC,SAASA,CAAA,EAAG;EAAAC,EAAA;EACnB,MAAM,CAACC,SAAS,EAAEC,YAAY,CAAC,GAAGd,QAAQ,CAAC,EAAE,CAAC;EAC9C,MAAM,CAACe,OAAO,EAAEC,UAAU,CAAC,GAAGhB,QAAQ,CAAC,IAAI,CAAC;EAC5C,MAAM,CAACiB,KAAK,EAAEC,QAAQ,CAAC,GAAGlB,QAAQ,CAAC,EAAE,CAAC;EACtC,MAAM,CAACmB,WAAW,EAAEC,cAAc,CAAC,GAAGpB,QAAQ,CAAC,KAAK,CAAC,CAAC,CAAC;EACvD,MAAM,CAACqB,wBAAwB,EAAEC,2BAA2B,CAAC,GAAGtB,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAC;EAChF,MAAMuB,QAAQ,GAAGnB,WAAW,CAAC,CAAC;EAC9B,MAAMoB,IAAI,GAAGC,IAAI,CAACC,KAAK,CAACC,YAAY,CAACC,OAAO,CAAC,MAAM,CAAC,CAAC;EAErD,MAAMC,cAAc,GAAG3B,WAAW,CAAC,YAAY;IAC7C;IACAc,UAAU,CAAC,IAAI,CAAC;IAChBE,QAAQ,CAAC,EAAE,CAAC;IACZJ,YAAY,CAAC,EAAE,CAAC,CAAC,CAAC;;IAElB,IAAI,CAACU,IAAI,IAAI,CAACA,IAAI,CAACM,EAAE,IAAI,OAAON,IAAI,CAACO,IAAI,KAAK,WAAW,EAAE;MACzDC,OAAO,CAACf,KAAK,CAAC,iDAAiD,CAAC;MAChEC,QAAQ,CAAC,6EAA6E,CAAC;MACvFF,UAAU,CAAC,KAAK,CAAC;MACjBW,YAAY,CAACM,UAAU,CAAC,MAAM,CAAC,CAAC,CAAC;MACjCV,QAAQ,CAAC,QAAQ,CAAC,CAAC,CAAC;MACpB;IACF;IAEA,IAAI;MACFS,OAAO,CAACE,GAAG,CAAC,8BAA8B,EAAE;QAAEC,MAAM,EAAEX,IAAI,CAACM,EAAE;QAAEC,IAAI,EAAEP,IAAI,CAACO;MAAK,CAAC,CAAC;MACjF,MAAMK,QAAQ,GAAG,MAAMjC,KAAK,CAACkC,GAAG,CAAC,qCAAqC,EAAE;QACtEC,MAAM,EAAE;UACNH,MAAM,EAAEX,IAAI,CAACM,EAAE;UACfC,IAAI,EAAEP,IAAI,CAACO;QACb;MACF,CAAC,CAAC;MACFC,OAAO,CAACE,GAAG,CAAC,qBAAqB,EAAEE,QAAQ,CAACG,IAAI,CAAC;;MAEjD;MACA,MAAMC,iBAAiB,GAAGC,KAAK,CAACC,OAAO,CAACN,QAAQ,CAACG,IAAI,CAAC,GAAGH,QAAQ,CAACG,IAAI,GAAG,EAAE;MAE3EC,iBAAiB,CAACG,OAAO,CAAC,CAACC,GAAG,EAAEC,KAAK,KAAK;QACtCb,OAAO,CAACE,GAAG,CAAC,YAAYW,KAAK,GAAG,CAAC,GAAG,EAAE;UACpCC,SAAS,EAAEF,GAAG,CAACE,SAAS;UACxBC,UAAU,EAAEH,GAAG,CAACG,UAAU;UAC1BC,UAAU,EAAEJ,GAAG,CAACI,UAAU;UAC1B;UACAC,QAAQ,EAAEL,GAAG,CAACK,QAAQ;UACtBC,QAAQ,EAAEN,GAAG,CAACM,QAAQ;UACtBC,QAAQ,EAAEP,GAAG,CAACO,QAAQ;UACtBC,UAAU,EAAER,GAAG,CAACQ,UAAU;UAC1BC,WAAW,EAAET,GAAG,CAACS,WAAW;UAC5BC,SAAS,EAAEV,GAAG,CAACU,SAAS;UACxBC,WAAW,EAAEX,GAAG,CAACW,WAAW,CAAC;QAC/B,CAAC,CAAC;MACN,CAAC,CAAC;MAEFzC,YAAY,CAAC0B,iBAAiB,CAAC;MAC/BxB,UAAU,CAAC,KAAK,CAAC;IACnB,CAAC,CAAC,OAAOwC,GAAG,EAAE;MAAA,IAAAC,aAAA,EAAAC,kBAAA;MACZ1B,OAAO,CAACf,KAAK,CAAC,iCAAiC,EAAEuC,GAAG,CAAC;MACrD,MAAMG,YAAY,GAAG,EAAAF,aAAA,GAAAD,GAAG,CAACpB,QAAQ,cAAAqB,aAAA,wBAAAC,kBAAA,GAAZD,aAAA,CAAclB,IAAI,cAAAmB,kBAAA,uBAAlBA,kBAAA,CAAoBzC,KAAK,KAAIuC,GAAG,CAACI,OAAO,IAAI,4CAA4C;MAC7G1C,QAAQ,CAAC,mCAAmCyC,YAAY,EAAE,CAAC;MAC3D3C,UAAU,CAAC,KAAK,CAAC;IACnB;EACF,CAAC,EAAE,CAACQ,IAAI,aAAJA,IAAI,uBAAJA,IAAI,CAAEM,EAAE,EAAEN,IAAI,aAAJA,IAAI,uBAAJA,IAAI,CAAEO,IAAI,EAAER,QAAQ,CAAC,CAAC,CAAC,CAAC;;EAEtCtB,SAAS,CAAC,MAAM;IACd;IACA,IAAIuB,IAAI,IAAIA,IAAI,CAACM,EAAE,IAAI,OAAON,IAAI,CAACO,IAAI,KAAK,WAAW,EAAE;MACrDF,cAAc,CAAC,CAAC;IACpB,CAAC,MAAM;MACH;MACAX,QAAQ,CAAC,sEAAsE,CAAC;MAChFF,UAAU,CAAC,KAAK,CAAC;MACjB;MACA,MAAM6C,KAAK,GAAGC,UAAU,CAAC,MAAM;QAC3BvC,QAAQ,CAAC,QAAQ,CAAC;MACtB,CAAC,EAAE,IAAI,CAAC;MACR,OAAO,MAAMwC,YAAY,CAACF,KAAK,CAAC,CAAC,CAAC;IACtC;EACF,CAAC,EAAE,CAAChC,cAAc,EAAEL,IAAI,EAAED,QAAQ,CAAC,CAAC,CAAC,CAAC;;EAEtC;EACA,MAAMyC,SAAS,GAAIpB,GAAG,IAAK;IACzBZ,OAAO,CAACE,GAAG,CAAC,wBAAwB,EAAEU,GAAG,CAAC,CAAC,CAAC;IAC5CtB,2BAA2B,CAACsB,GAAG,CAAC;IAChCxB,cAAc,CAAC,IAAI,CAAC;EACtB,CAAC;EAED,MAAM6C,UAAU,GAAGA,CAAA,KAAM;IACvB7C,cAAc,CAAC,KAAK,CAAC;IACrBE,2BAA2B,CAAC,IAAI,CAAC;EACnC,CAAC;;EAED;EACA,MAAM4C,UAAU,GAAIC,UAAU,IAAK;IACjC,IAAI,CAACA,UAAU,EAAE,OAAO,KAAK;IAC7B,IAAI;MACF,MAAMC,IAAI,GAAG,IAAIC,IAAI,CAACF,UAAU,CAAC;MACjC;MACA,IAAIG,KAAK,CAACF,IAAI,CAACG,OAAO,CAAC,CAAC,CAAC,EAAE;QACvB,OAAO,eAAe;MAC1B;MACA,OAAOH,IAAI,CAACI,kBAAkB,CAAC,OAAO,CAAC,CAAC,CAAC;IAC3C,CAAC,CAAC,OAAOC,CAAC,EAAE;MACVzC,OAAO,CAACf,KAAK,CAAC,wBAAwB,EAAEkD,UAAU,EAAEM,CAAC,CAAC;MACtD,OAAO,aAAa;IACtB;EACF,CAAC;;EAED;EACA,MAAMC,YAAY,GAAGA,CAAA,KAAM;IACzB/C,YAAY,CAACM,UAAU,CAAC,MAAM,CAAC;IAC/BV,QAAQ,CAAC,QAAQ,CAAC;EACpB,CAAC;EAED,MAAMoD,UAAU,GAAGA,CAAA,KAAM;IACvB;IACA,IAAInD,IAAI,EAAE;MACRD,QAAQ,CAACC,IAAI,CAACO,IAAI,KAAK,CAAC,GAAG,QAAQ,GAAG,OAAO,CAAC;IAChD,CAAC,MAAM;MACLR,QAAQ,CAAC,QAAQ,CAAC,CAAC,CAAC;IACtB;EACF,CAAC;;EAED;EACA,IAAIR,OAAO,EAAE,oBAAOR,OAAA;IAAKqE,SAAS,EAAC,SAAS;IAAAC,QAAA,EAAC;EAAW;IAAAC,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OAAK,CAAC;EAC9D;EACA,IAAIhE,KAAK,EAAE,oBAAOV,OAAA;IAAKqE,SAAS,EAAC,iBAAiB;IAAAC,QAAA,gBAC5BtE,OAAA;MAAGqE,SAAS,EAAC,OAAO;MAAAC,QAAA,EAAE5D;IAAK;MAAA6D,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAI,CAAC,eAChC1E,OAAA;MAAQ2E,OAAO,EAAEP,UAAW;MAACC,SAAS,EAAC,aAAa;MAAAC,QAAA,EAAC;IAAK;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAQ,CAAC,eACnE1E,OAAA;MAAQ2E,OAAO,EAAER,YAAa;MAACE,SAAS,EAAC,eAAe;MAAAC,QAAA,EAAC;IAAK;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAQ,CAAC;EAAA;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACtE,CAAC;EACxB;EACA,IAAI,CAACzD,IAAI,EAAE,oBAAOjB,OAAA;IAAKqE,SAAS,EAAC,OAAO;IAAAC,QAAA,GAAC,kMAAqC,eAAAtE,OAAA;MAAQ2E,OAAO,EAAEA,CAAA,KAAM3D,QAAQ,CAAC,QAAQ,CAAE;MAAAsD,QAAA,EAAC;IAAK;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAQ,CAAC;EAAA;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OAAK,CAAC;;EAG7I;EACA;EACA;EACA,MAAME,kBAAkB,GAAIvC,GAAG,IAAK;IAChC,IAAIpB,IAAI,CAACO,IAAI,KAAK,CAAC,EAAE;MACjB,OAAO,CAAAa,GAAG,aAAHA,GAAG,uBAAHA,GAAG,CAAEQ,UAAU,KAAI,KAAK,CAAC,CAAC;IACrC,CAAC,MAAM;MACH;MACA,OAAO,CAAA5B,IAAI,aAAJA,IAAI,uBAAJA,IAAI,CAAE4D,IAAI,MAAI5D,IAAI,aAAJA,IAAI,uBAAJA,IAAI,CAAE6D,QAAQ,KAAI,KAAK,CAAC,CAAC;IAClD;EACJ,CAAC;EAGD,oBACE9E,OAAA;IAAKqE,SAAS,EAAC,qBAAqB;IAAAC,QAAA,gBAClCtE,OAAA;MAAKqE,SAAS,EAAC,kBAAkB;MAAAC,QAAA,gBAC/BtE,OAAA;QAAAsE,QAAA,EAAKrD,IAAI,CAACO,IAAI,KAAK,CAAC,GAAG,eAAe,GAAG;MAAe;QAAA+C,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAK,CAAC,eAC9D1E,OAAA;QAAKqE,SAAS,EAAC,gBAAgB;QAAAC,QAAA,gBAC7BtE,OAAA;UAAQ2E,OAAO,EAAEP,UAAW;UAACC,SAAS,EAAC,aAAa;UAAAC,QAAA,EAAC;QAAK;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAQ,CAAC,eACnE1E,OAAA;UAAQ2E,OAAO,EAAER,YAAa;UAACE,SAAS,EAAC,eAAe;UAAAC,QAAA,EAAC;QAAK;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAQ,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACpE,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACH,CAAC,eAGN1E,OAAA;MAAKqE,SAAS,EAAC,gBAAgB;MAAAC,QAAA,EAE5BhE,SAAS,CAACyE,MAAM,GAAG,CAAC,gBACnB/E,OAAA;QAAOqE,SAAS,EAAC,iBAAiB;QAAAC,QAAA,gBAChCtE,OAAA;UAAAsE,QAAA,eACEtE,OAAA;YAAAsE,QAAA,GAEGrD,IAAI,CAACO,IAAI,KAAK,CAAC,iBAAIxB,OAAA;cAAAsE,QAAA,EAAI;YAAQ;cAAAC,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAI,CAAC,eACrC1E,OAAA;cAAAsE,QAAA,EAAI;YAAkB;cAAAC,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAI,CAAC,eAC3B1E,OAAA;cAAAsE,QAAA,EAAI;YAAoB;cAAAC,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAI,CAAC,KAAC,eAC9B1E,OAAA;cAAAsE,QAAA,EAAI;YAAU;cAAAC,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAI,CAAC,eACnB1E,OAAA;cAAAsE,QAAA,EAAI;YAAW;cAAAC,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAI,CAAC,eACpB1E,OAAA;cAAAsE,QAAA,EAAI;YAAQ;cAAAC,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAI,CAAC,KAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAChB;QAAC;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACA,CAAC,eACR1E,OAAA;UAAAsE,QAAA,EACGhE,SAAS,CAAC0E,GAAG,CAAE3C,GAAG,iBACjBrC,OAAA;YAAAsE,QAAA,GAA2C,GAAC,EAEzCrD,IAAI,CAACO,IAAI,KAAK,CAAC,iBAAIxB,OAAA;cAAAsE,QAAA,EAAKjC,GAAG,CAACQ,UAAU,IAAI;YAAK;cAAA0B,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAK,CAAC,eAEtD1E,OAAA;cAAAsE,QAAA,EAAKjC,GAAG,CAACS,WAAW,IAAI;YAAK;cAAAyB,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAK,CAAC,eAEnC1E,OAAA;cAAAsE,QAAA,EAAKjC,GAAG,CAACK,QAAQ,IAAIL,GAAG,CAACM,QAAQ,IAAI;YAAK;cAAA4B,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAK,CAAC,eAChD1E,OAAA;cAAAsE,QAAA,EAAKjC,GAAG,CAACE,SAAS,IAAI;YAAK;cAAAgC,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAK,CAAC,eACjC1E,OAAA;cAAAsE,QAAA,EAAKX,UAAU,CAACtB,GAAG,CAACU,SAAS;YAAC;cAAAwB,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAK,CAAC,KAAC,eACrC1E,OAAA;cAAAsE,QAAA,eAEEtE,OAAA;gBACEqE,SAAS,EAAC,gBAAgB;gBAC1BM,OAAO,EAAEA,CAAA,KAAMlB,SAAS,CAACpB,GAAG,CAAE,CAAC;gBAAA;gBAAAiC,QAAA,EAChC;cAED;gBAAAC,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAQ;YAAC;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACP,CAAC;UAAA,GAjBErC,GAAG,CAACW,WAAW,IAAIX,GAAG,CAACE,SAAS;YAAAgC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAkBrC,CACL;QAAC;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACG,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACH,CAAC;MAAA;MAER;MACA1E,OAAA;QAAKqE,SAAS,EAAC,oCAAoC;QAAAC,QAAA,eACjDtE,OAAA;UAAGqE,SAAS,EAAC,cAAc;UAAAC,QAAA,EACxBrD,IAAI,CAACO,IAAI,KAAK,CAAC,GACZ,uCAAuC,GACvC;QAAwC;UAAA+C,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAE3C;MAAC;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACD;IACN;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACE,CAAC,eAGN1E,OAAA,CAACF,KAAK;MACJmF,MAAM,EAAErE,WAAY;MACpBsE,cAAc,EAAExB,UAAW;MAC3ByB,YAAY,EAAC,6FAAkB,CAAC;MAAA;MAChCd,SAAS,EAAC,eAAe,CAAC;MAAA;MAC1Be,gBAAgB,EAAC,eAAe,CAAC;MAAA;MACjCC,WAAW,EAAE,KAAM,CAAC;MAAA;MAAAf,QAAA,EAGnBxD,wBAAwB,gBACvBd,OAAA,CAAAE,SAAA;QAAAoE,QAAA,gBAEEtE,OAAA;UAAKqE,SAAS,EAAC,cAAc;UAAAC,QAAA,gBACzBtE,OAAA;YAAAsE,QAAA,GAAI,qGAAmB,EAACxD,wBAAwB,CAACyB,SAAS,IAAIzB,wBAAwB,CAACkC,WAAW,IAAI,KAAK;UAAA;YAAAuB,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAK,CAAC,eACjH1E,OAAA;YAAQ2E,OAAO,EAAEjB,UAAW;YAACW,SAAS,EAAC,oBAAoB;YAAC,cAAW,4CAAS;YAAAC,QAAA,EAAC;UAAO;YAAAC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAQ,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAChG,CAAC,eAGN1E,OAAA;UAAKqE,SAAS,EAAC,YAAY;UAAAC,QAAA,eACzBtE,OAAA;YAAKqE,SAAS,EAAC,oBAAoB;YAAAC,QAAA,gBAG/BtE,OAAA;cAAAsE,QAAA,gBAAGtE,OAAA;gBAAAsE,QAAA,EAAQ;cAAS;gBAAAC,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAQ,CAAC,KAAC,EAACE,kBAAkB,CAAC9D,wBAAwB,CAAC;YAAA;cAAAyD,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAI,CAAC,eAChF1E,OAAA;cAAAsE,QAAA,gBAAGtE,OAAA;gBAAAsE,QAAA,EAAQ;cAAmB;gBAAAC,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAQ,CAAC,KAAC,EAAC5D,wBAAwB,CAACgC,WAAW,IAAI,KAAK;YAAA;cAAAyB,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAI,CAAC,eAC3F1E,OAAA;cAAAsE,QAAA,gBAAGtE,OAAA;gBAAAsE,QAAA,EAAQ;cAAqB;gBAAAC,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAQ,CAAC,KAAC,EAAC5D,wBAAwB,CAAC6B,QAAQ,IAAI,KAAK;YAAA;cAAA4B,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAI,CAAC,eAC1F1E,OAAA;cAAAsE,QAAA,gBAAGtE,OAAA;gBAAAsE,QAAA,EAAQ;cAAsB;gBAAAC,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAQ,CAAC,KAAC,EAAC5D,wBAAwB,CAAC4B,QAAQ,IAAI,KAAK;YAAA;cAAA6B,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAI,CAAC,eAC3F1E,OAAA;cAAAsE,QAAA,gBAAGtE,OAAA;gBAAAsE,QAAA,EAAQ;cAAsB;gBAAAC,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAQ,CAAC,KAAC,EAAC5D,wBAAwB,CAACyB,SAAS,IAAI,KAAK;YAAA;cAAAgC,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAI,CAAC,eAC5F1E,OAAA;cAAAsE,QAAA,gBAAGtE,OAAA;gBAAAsE,QAAA,EAAQ;cAAY;gBAAAC,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAQ,CAAC,KAAC,EAAC5D,wBAAwB,CAAC0B,UAAU,IAAI,KAAK;YAAA;cAAA+B,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAI,CAAC,KAAC,eACpF1E,OAAA;cAAAsE,QAAA,gBAAGtE,OAAA;gBAAAsE,QAAA,EAAQ;cAAY;gBAAAC,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAQ,CAAC,KAAC,EAAC5D,wBAAwB,CAAC2B,UAAU,IAAI,KAAK;YAAA;cAAA8B,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAI,CAAC,KAAC,eACpF1E,OAAA;cAAAsE,QAAA,gBAAGtE,OAAA;gBAAAsE,QAAA,EAAQ;cAAY;gBAAAC,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAQ,CAAC,KAAC,EAACf,UAAU,CAAC7C,wBAAwB,CAACiC,SAAS,CAAC;YAAA;cAAAwB,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAI,CAAC,eACrF1E,OAAA;cAAAsE,QAAA,gBAAGtE,OAAA;gBAAAsE,QAAA,EAAQ;cAAY;gBAAAC,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAQ,CAAC,KAAC,EAACf,UAAU,CAAC7C,wBAAwB,CAACwE,SAAS,CAAC;YAAA;cAAAf,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAI,CAAC,KAAC,eACtF1E,OAAA;cAAAsE,QAAA,gBAAGtE,OAAA;gBAAAsE,QAAA,EAAQ;cAAe;gBAAAC,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAQ,CAAC,KAAC,EAACf,UAAU,CAAC7C,wBAAwB,CAACyE,OAAO,CAAC;YAAA;cAAAhB,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAI,CAAC,KAAC,eAGvF1E,OAAA;cAAGqE,SAAS,EAAC,4BAA4B;cAAAC,QAAA,GAAC,GAAC,eACvCtE,OAAA;gBAAAsE,QAAA,EAAQ;cAAa;gBAAAC,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAQ,CAAC,EAE7BxC,KAAK,CAACC,OAAO,CAACrB,wBAAwB,CAAC8B,QAAQ,CAAC,IAAI9B,wBAAwB,CAAC8B,QAAQ,CAACmC,MAAM,GAAG,CAAC,GAC3FjE,wBAAwB,CAAC8B,QAAQ,CAC5BoC,GAAG,CAACQ,CAAC,IAAI,CAAAA,CAAC,aAADA,CAAC,uBAADA,CAAC,CAAEC,QAAQ,MAAID,CAAC,aAADA,CAAC,uBAADA,CAAC,CAAEE,SAAS,KAAIF,CAAC,CAAC,CAAC;cAAA,CAC3CG,MAAM,CAACC,OAAO,CAAC,CAAC;cAAA,CAChBC,IAAI,CAAC,IAAI,CAAC,CAAC;cAAA,EAChB,aAAa,EAAC,GAAC;YAAA;cAAAtB,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACtB,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACH;QAAC;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACH,CAAC;MAAA,eAKN,CAAC;MAAA;MAED;MACA1E,OAAA;QAAAsE,QAAA,EAAG;MAAmB;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAG;IAC5B;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACI,CAAC;EAAA;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACL,CAAC;AAEV;AAACrE,EAAA,CA7QQD,SAAS;EAAA,QAMCP,WAAW;AAAA;AAAAiG,EAAA,GANrB1F,SAAS;AA+QlB,eAAeA,SAAS;AAAC,IAAA0F,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}